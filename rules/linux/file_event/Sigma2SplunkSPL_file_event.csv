File Name,Rule Title,Rule ID,Rule Description,Chinese Title,Chinese Description,Level,References,Tags,Logsource,Fields,FalsePositive,Error Translation,Detection,SPL Query
file_event_lnx_triple_cross_rootkit_persistence.yml,Triple Cross eBPF Rootkit Default Persistence,1a2ea919-d11d-4d1e-8535-06cda13be20f,"Detects the creation of ""ebpfbackdoor"" files in both ""cron.d"" and ""sudoers.d"" directories. Which both are related to the TripleCross persistence method",三重交叉EBPF rootkit默认持久性,检测“ cron.d”和“ sudoers.d”目录中的“ ebpfbackdoor”文件的创建。这两者都与Triplecross持久方法有关,high,https://github.com/h3xduck/TripleCross/blob/12629558b8b0a27a5488a0b98f1ea7042e76f8ab/apps/deployer.sh,"attack.persistence, attack.defense_evasion, attack.t1053.003","product: linux, service: None",,['Unlikely'],,"{'selection': {'TargetFilename|endswith': 'ebpfbackdoor'}, 'condition': 'selection'}","TargetFilename=""*ebpfbackdoor"""
file_event_lnx_doas_conf_creation.yml,Linux Doas Conf File Creation,00eee2a5-fdb0-4746-a21d-e43fbdea5681,Detects the creation of doas.conf file in linux host platform.,Linux DOAS Conf File创建,检测Linux主机平台中doas.conf文件的创建。,medium,"https://research.splunk.com/endpoint/linux_doas_conf_file_creation/, https://www.makeuseof.com/how-to-install-and-use-doas/","attack.privilege_escalation, attack.t1548","product: linux, service: None",,['Unlikely'],,"{'selection': {'TargetFilename|endswith': '/etc/doas.conf'}, 'condition': 'selection'}","TargetFilename=""*/etc/doas.conf"""
file_event_lnx_persistence_sudoers_files.yml,Persistence Via Sudoers Files,ddb26b76-4447-4807-871f-1b035b2bfa5d,"Detects creation of sudoers file or files in ""sudoers.d"" directory which can be used a potential method to persiste privileges for a specific user.",通过sudoers文件的持久性,检测“ sudoers.d”目录中的sudoers文件或文件的创建，该目录可以使用潜在的方法来为特定用户持续特权。,medium,https://github.com/h3xduck/TripleCross/blob/1f1c3e0958af8ad9f6ebe10ab442e75de33e91de/apps/deployer.sh,"attack.persistence, attack.t1053.003","product: linux, service: None",,['Creation of legitimate files in sudoers.d folder part of administrator work'],,"{'selection': {'TargetFilename|startswith': '/etc/sudoers.d/'}, 'condition': 'selection'}","TargetFilename=""/etc/sudoers.d/*"""
file_event_lnx_susp_shell_script_under_profile_directory.yml,Potentially Suspicious Shell Script Creation in Profile Folder,13f08f54-e705-4498-91fd-cce9d9cee9f1,"Detects the creation of shell scripts under the ""profile.d"" path.",在配置文件夹中可能会创建可疑的外壳脚本,检测“配置文件”路径下的shell脚本的创建。,low,"https://blogs.jpcert.or.jp/en/2023/05/gobrat.html, https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/, https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection, https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection",attack.persistence,"product: linux, service: None",,"['Legitimate shell scripts in the ""profile.d"" directory could be common in your environment. Apply additional filter accordingly via ""image"", by adding specific filenames you ""trust"" or by correlating it with other events.', 'Regular file creation during system update or software installation by the package manager']",,"{'selection': {'TargetFilename|contains': '/etc/profile.d/', 'TargetFilename|endswith': ['.csh', '.sh']}, 'condition': 'selection'}","TargetFilename=""*/etc/profile.d/*"" TargetFilename IN (""*.csh"", ""*.sh"")"
file_event_lnx_wget_download_file_in_tmp_dir.yml,Wget Creating Files in Tmp Directory,35a05c60-9012-49b6-a11f-6bab741c9f74,"Detects the use of wget to download content in a temporary directory such as ""/tmp"" or ""/var/tmp""",WGET在TMP目录中创建文件,检测使用WGET在临时目录中下载内容的使用，例如“/tmp”或“/var/tmp”,medium,"https://blogs.jpcert.or.jp/en/2023/05/gobrat.html, https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/, https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection, https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection","attack.command_and_control, attack.t1105","product: linux, service: None",,['Legitimate downloads of files in the tmp folder.'],,"{'selection': {'Image|endswith': '/wget', 'TargetFilename|startswith': ['/tmp/', '/var/tmp/']}, 'condition': 'selection'}","Image=""*/wget"" TargetFilename IN (""/tmp/*"", ""/var/tmp/*"")"
file_event_lnx_persistence_cron_files.yml,Persistence Via Cron Files,6c4e2f43-d94d-4ead-b64d-97e53fa2bd05,Detects creation of cron file or files in Cron directories which could indicates potential persistence.,通过cron文件的持久性,检测CRON文件或CRON目录中的文件的创建，这可能表明潜在的持久性。,medium,https://github.com/microsoft/MSTIC-Sysmon/blob/f1477c0512b0747c1455283069c21faec758e29d/linux/configs/attack-based/persistence/T1053.003_Cron_Activity.xml,"attack.persistence, attack.t1053.003","product: linux, service: None",,['Any legitimate cron file.'],,"{'selection1': {'TargetFilename|startswith': ['/etc/cron.d/', '/etc/cron.daily/', '/etc/cron.hourly/', '/etc/cron.monthly/', '/etc/cron.weekly/', '/var/spool/cron/crontabs/']}, 'selection2': {'TargetFilename|contains': ['/etc/cron.allow', '/etc/cron.deny', '/etc/crontab']}, 'condition': '1 of selection*'}","TargetFilename IN (""/etc/cron.d/*"", ""/etc/cron.daily/*"", ""/etc/cron.hourly/*"", ""/etc/cron.monthly/*"", ""/etc/cron.weekly/*"", ""/var/spool/cron/crontabs/*"") OR TargetFilename IN (""*/etc/cron.allow*"", ""*/etc/cron.deny*"", ""*/etc/crontab*"")"
file_event_lnx_triple_cross_rootkit_lock_file.yml,Triple Cross eBPF Rootkit Default LockFile,c0239255-822c-4630-b7f1-35362bcb8f44,"Detects the creation of the file ""rootlog"" which is used by the TripleCross rootkit as a way to check if the backdoor is already running.",三重交叉EBPF rootkit默认lockfile,检测文件“ rootlog”的创建，该文件被Triplecross rootkit用作检查后门是否已经运行的方法。,high,https://github.com/h3xduck/TripleCross/blob/1f1c3e0958af8ad9f6ebe10ab442e75de33e91de/src/helpers/execve_hijack.c#L33,attack.defense_evasion,"product: linux, service: None",,['Unlikely'],,"{'selection': {'TargetFilename': '/tmp/rootlog'}, 'condition': 'selection'}","TargetFilename=""/tmp/rootlog"""
