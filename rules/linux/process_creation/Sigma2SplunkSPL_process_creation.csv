File Name,Rule Title,Rule ID,Rule Description,Chinese Title,Chinese Description,Level,References,Tags,Logsource,Fields,FalsePositive,Error Translation,Detection,SPL Query
proc_creation_lnx_triple_cross_rootkit_execve_hijack.yml,Triple Cross eBPF Rootkit Execve Hijack,0326c3c8-7803-4a0f-8c5c-368f747f7c3e,"Detects execution of a the file ""execve_hijack"" which is used by the Triple Cross rootkit as a way to elevate privileges",三重交叉EBPF rootkit执行劫持,检测执行文件“ execve_hijack”的执行,high,https://github.com/h3xduck/TripleCross/blob/1f1c3e0958af8ad9f6ebe10ab442e75de33e91de/src/helpers/execve_hijack.c#L275,"attack.defense_evasion, attack.privilege_escalation","product: linux, service: None",,['Unlikely'],,"{'selection': {'Image|endswith': '/sudo', 'CommandLine|contains': 'execve_hijack'}, 'condition': 'selection'}","Image=""*/sudo"" CommandLine=""*execve_hijack*"""
proc_creation_lnx_esxcli_storage_discovery.yml,ESXi Storage Information Discovery Via ESXCLI,f41dada5-3f56-4232-8503-3fb7f9cf2d60,"Detects execution of the ""esxcli"" command with the ""storage"" flag in order to retrieve information about the storage status and other related information. Seen used by malware such as DarkSide and LockBit.",ESXI存储信息通过ESXCLI发现,检测具有“存储”标志的“ ESXCLI”命令的执行，以检索有关存储状态和其他相关信息的信息。通过恶意软件（例如Darkside和Lockbit）使用。,medium,"https://www.trendmicro.com/en_us/research/21/e/darkside-linux-vms-targeted.html, https://www.trendmicro.com/en_us/research/22/a/analysis-and-Impact-of-lockbit-ransomwares-first-linux-and-vmware-esxi-variant.html, https://developer.vmware.com/docs/11743/esxi-7-0-esxcli-command-reference/namespace/esxcli_storage.html","attack.discovery, attack.t1033, attack.t1007","product: linux, service: None",,['Legitimate administration activities'],,"{'selection_img': {'Image|endswith': '/esxcli', 'CommandLine|contains': 'storage'}, 'selection_cli': {'CommandLine|contains': [' get', ' list']}, 'condition': 'all of selection_*'}","Image=""*/esxcli"" CommandLine=""*storage*"" CommandLine IN (""* get*"", ""* list*"")"
proc_creation_lnx_bpftrace_unsafe_option_usage.yml,BPFtrace Unsafe Option Usage,f8341cb2-ee25-43fa-a975-d8a5a9714b39,Detects the usage of the unsafe bpftrace option,bpftrace不安全的选项,检测不安全BPFTRACE选项的使用情况,medium,"https://embracethered.com/blog/posts/2021/offensive-bpf-bpftrace/, https://bpftrace.org/","attack.execution, attack.t1059.004","product: linux, service: None",,['Legitimate usage of the unsafe option'],,"{'selection': {'Image|endswith': 'bpftrace', 'CommandLine|contains': '--unsafe'}, 'condition': 'selection'}","Image=""*bpftrace"" CommandLine=""*--unsafe*"""
proc_creation_lnx_ssm_agent_abuse.yml,Potential Linux Amazon SSM Agent Hijacking,f9b3edc5-3322-4fc7-8aa3-245d646cc4b7,Detects potential Amazon SSM agent hijack attempts as outlined in the Mitiga research report.,潜在的Linux Amazon SSM代理商劫持,如Mitiga研究报告中概述的那样，检测了潜在的亚马逊SSM代理商劫持尝试。,medium,"https://www.mitiga.io/blog/mitiga-security-advisory-abusing-the-ssm-agent-as-a-remote-access-trojan, https://www.bleepingcomputer.com/news/security/amazons-aws-ssm-agent-can-be-used-as-post-exploitation-rat-malware/, https://www.helpnetsecurity.com/2023/08/02/aws-instances-attackers-access/","attack.command_and_control, attack.persistence, attack.t1219","product: linux, service: None",,['Legitimate activity of system administrators'],,"{'selection': {'Image|endswith': '/amazon-ssm-agent', 'CommandLine|contains|all': ['-register ', '-code ', '-id ', '-region ']}, 'condition': 'selection'}","Image=""*/amazon-ssm-agent"" CommandLine=""*-register *"" CommandLine=""*-code *"" CommandLine=""*-id *"" CommandLine=""*-region *"""
proc_creation_lnx_mkfifo_named_pipe_creation.yml,Named Pipe Created Via Mkfifo,9d779ce8-5256-4b13-8b6f-b91c602b43f4,"Detects the creation of a new named pipe using the ""mkfifo"" utility",通过MKFIFO创建的命名管道,检测使用“ MKFIFO”实用程序的新名称管道的创建,low,"https://dev.to/0xbf/use-mkfifo-to-create-named-pipe-linux-tips-5bbk, https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally",attack.execution,"product: linux, service: None",,['Unknown'],,"{'selection': {'Image|endswith': '/mkfifo'}, 'condition': 'selection'}","Image=""*/mkfifo"""
proc_creation_lnx_curl_usage.yml,Curl Usage on Linux,ea34fb97-e2c4-4afb-810f-785e4459b194,"Detects a curl process start on linux, which indicates a file download from a remote location or a simple web request to a remote server",Linux上的卷曲用法,检测Linux上的卷曲过程，该过程指示文件从远程位置下载或简单的Web请求到远程服务器,low,https://www.trendmicro.com/en_us/research/22/i/how-malicious-actors-abuse-native-linux-tools-in-their-attacks.html,"attack.command_and_control, attack.t1105","product: linux, service: None",,"['Scripts created by developers and admins', 'Administrative activity']",,"{'selection': {'Image|endswith': '/curl'}, 'condition': 'selection'}","Image=""*/curl"""
proc_creation_lnx_perl_reverse_shell.yml,Potential Perl Reverse Shell Execution,259df6bc-003f-4306-9f54-4ff1a08fa38e,"Detects execution of the perl binary with the ""-e"" flag and common strings related to potential reverse shell activity",潜在的perl反向外壳执行,检测使用“ -e”标志的Perl二进制执行和与潜在反向外壳活动相关的常见字符串,high,"https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet, https://www.revshells.com/",attack.execution,"product: linux, service: None",,['Unlikely'],,"{'selection_img': {'Image|endswith': '/perl', 'CommandLine|contains': ' -e '}, 'selection_content': [{'CommandLine|contains|all': ['fdopen(', '::Socket::INET']}, {'CommandLine|contains|all': ['Socket', 'connect', 'open', 'exec']}], 'condition': 'all of selection_*'}","Image=""*/perl"" CommandLine=""* -e *"" (CommandLine=""*fdopen(*"" CommandLine=""*::Socket::INET*"") OR (CommandLine=""*Socket*"" CommandLine=""*connect*"" CommandLine=""*open*"" CommandLine=""*exec*"")"
proc_creation_lnx_at_command.yml,Scheduled Task/Job At,d2d642d7-b393-43fe-bae4-e81ed5915c4b,"Detects the use of at/atd which are utilities that are used to schedule tasks.
They are often abused by adversaries to maintain persistence or to perform task scheduling for initial or recurring execution of malicious code
",预定的任务/工作,"检测AT/ATD的使用，这些用户是用于安排任务的实用程序。
他们经常被对手虐待以保持持久性或执行任务计划以初次或重复执行恶意代码",low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.002/T1053.002.md,"attack.persistence, attack.t1053.002","product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'Image|endswith': ['/at', '/atd']}, 'condition': 'selection'}","Image IN (""*/at"", ""*/atd"")"
proc_creation_lnx_malware_gobrat_grep_payload_discovery.yml,Potential GobRAT File Discovery Via Grep,e34cfa0c-0a50-4210-9cb3-5632d08eb041,Detects the use of grep to discover specific files created by the GobRAT malware,通过GREP发现潜在的gobrat文件发现,检测使用GREP来发现gobrat恶意软件创建的特定文件,high,"https://blogs.jpcert.or.jp/en/2023/05/gobrat.html, https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection, https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection","attack.discovery, attack.t1082","product: linux, service: None",,['Unknown'],,"{'selection': {'Image|endswith': '/grep', 'CommandLine|contains': ['apached', 'frpc', 'sshd.sh', 'zone.arm']}, 'condition': 'selection'}","Image=""*/grep"" CommandLine IN (""*apached*"", ""*frpc*"", ""*sshd.sh*"", ""*zone.arm*"")"
proc_creation_lnx_susp_java_children.yml,Suspicious Java Children Processes,d292e0af-9a18-420c-9525-ec0ac3936892,Detects java process spawning suspicious children,可疑的爪哇儿童处理,检测Java过程产卵可疑孩子,high,https://www.tecmint.com/different-types-of-linux-shells/,"attack.execution, attack.t1059","product: linux, service: None",,['Unknown'],,"{'selection': {'ParentImage|endswith': '/java', 'CommandLine|contains': ['/bin/sh', 'bash', 'dash', 'ksh', 'zsh', 'csh', 'fish', 'curl', 'wget', 'python']}, 'condition': 'selection'}","ParentImage=""*/java"" CommandLine IN (""*/bin/sh*"", ""*bash*"", ""*dash*"", ""*ksh*"", ""*zsh*"", ""*csh*"", ""*fish*"", ""*curl*"", ""*wget*"", ""*python*"")"
proc_creation_lnx_security_tools_disabling.yml,Disabling Security Tools,e3a8a052-111f-4606-9aee-f28ebeb76776,Detects disabling security tools,禁用安全工具,检测禁用安全工具,medium,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md,"attack.defense_evasion, attack.t1562.004","product: linux, service: None",,['Legitimate administration activities'],,"{'selection_iptables_1': {'Image|endswith': '/service', 'CommandLine|contains|all': ['iptables', 'stop']}, 'selection_iptables_2': {'Image|endswith': '/service', 'CommandLine|contains|all': ['ip6tables', 'stop']}, 'selection_iptables_3': {'Image|endswith': '/chkconfig', 'CommandLine|contains|all': ['iptables', 'stop']}, 'selection_iptables_4': {'Image|endswith': '/chkconfig', 'CommandLine|contains|all': ['ip6tables', 'stop']}, 'selection_firewall_1': {'Image|endswith': '/systemctl', 'CommandLine|contains|all': ['firewalld', 'stop']}, 'selection_firewall_2': {'Image|endswith': '/systemctl', 'CommandLine|contains|all': ['firewalld', 'disable']}, 'selection_carbonblack_1': {'Image|endswith': '/service', 'CommandLine|contains|all': ['cbdaemon', 'stop']}, 'selection_carbonblack_2': {'Image|endswith': '/chkconfig', 'CommandLine|contains|all': ['cbdaemon', 'off']}, 'selection_carbonblack_3': {'Image|endswith': '/systemctl', 'CommandLine|contains|all': ['cbdaemon', 'stop']}, 'selection_carbonblack_4': {'Image|endswith': '/systemctl', 'CommandLine|contains|all': ['cbdaemon', 'disable']}, 'selection_selinux': {'Image|endswith': '/setenforce', 'CommandLine|contains': '0'}, 'selection_crowdstrike_1': {'Image|endswith': '/systemctl', 'CommandLine|contains|all': ['stop', 'falcon-sensor']}, 'selection_crowdstrike_2': {'Image|endswith': '/systemctl', 'CommandLine|contains|all': ['disable', 'falcon-sensor']}, 'condition': '1 of selection*'}","(Image=""*/service"" CommandLine=""*iptables*"" CommandLine=""*stop*"") OR (Image=""*/service"" CommandLine=""*ip6tables*"" CommandLine=""*stop*"") OR (Image=""*/chkconfig"" CommandLine=""*iptables*"" CommandLine=""*stop*"") OR (Image=""*/chkconfig"" CommandLine=""*ip6tables*"" CommandLine=""*stop*"") OR (Image=""*/systemctl"" CommandLine=""*firewalld*"" CommandLine=""*stop*"") OR (Image=""*/systemctl"" CommandLine=""*firewalld*"" CommandLine=""*disable*"") OR (Image=""*/service"" CommandLine=""*cbdaemon*"" CommandLine=""*stop*"") OR (Image=""*/chkconfig"" CommandLine=""*cbdaemon*"" CommandLine=""*off*"") OR (Image=""*/systemctl"" CommandLine=""*cbdaemon*"" CommandLine=""*stop*"") OR (Image=""*/systemctl"" CommandLine=""*cbdaemon*"" CommandLine=""*disable*"") OR (Image=""*/setenforce"" CommandLine=""*0*"") OR (Image=""*/systemctl"" CommandLine=""*stop*"" CommandLine=""*falcon-sensor*"") OR (Image=""*/systemctl"" CommandLine=""*disable*"" CommandLine=""*falcon-sensor*"")"
proc_creation_lnx_local_groups.yml,Local Groups Discovery - Linux,676381a6-15ca-4d73-a9c8-6a22e970b90d,Detects enumeration of local system groups. Adversaries may attempt to find local system groups and permission settings,本地团体发现-Linux,检测本地系统组的枚举。对手可能会尝试找到本地系统组和权限设置,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1069.001/T1069.001.md,"attack.discovery, attack.t1069.001","product: linux, service: None",,['Legitimate administration activities'],,"{'selection_1': {'Image|endswith': '/groups'}, 'selection_2': {'Image|endswith': ['/cat', '/head', '/tail', '/more'], 'CommandLine|contains': '/etc/group'}, 'condition': '1 of selection*'}","Image=""*/groups"" OR (Image IN (""*/cat"", ""*/head"", ""*/tail"", ""*/more"") CommandLine=""*/etc/group*"")"
proc_creation_lnx_system_network_connections_discovery.yml,System Network Connections Discovery - Linux,4c519226-f0cd-4471-bd2f-6fbb2bb68a79,Detects usage of system utilities to discover system network connections,系统网络连接发现-Linux,检测系统实用程序以发现系统网络连接的使用,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1049/T1049.md,"attack.discovery, attack.t1049","product: linux, service: None",,['Legitimate activities'],,"{'selection': {'Image|endswith': ['/who', '/w', '/last', '/lsof', '/netstat']}, 'filter_landscape_sysinfo': {'ParentCommandLine|contains': '/usr/bin/landscape-sysinfo', 'Image|endswith': '/who'}, 'condition': 'selection and not 1 of filter_*'}","Image IN (""*/who"", ""*/w"", ""*/last"", ""*/lsof"", ""*/netstat"") NOT (ParentCommandLine=""*/usr/bin/landscape-sysinfo*"" Image=""*/who"")"
proc_creation_lnx_crontab_removal.yml,Remove Scheduled Cron Task/Job,c2e234de-03a3-41e1-b39a-1e56dc17ba67,"Detects usage of the 'crontab' utility to remove the current crontab.
This is a common occurrence where cryptocurrency miners compete against each other by removing traces of other miners to hijack the maximum amount of resources possible
",删除预定的cron任务/作业,"检测使用“ crontab”实用程序以删除当前的crontab。
这是一个常见的情况，加密货币矿工通过删除其他矿工的痕迹来劫持可能的最大资源数量，从而相互竞争",medium,https://www.trendmicro.com/en_us/research/22/i/how-malicious-actors-abuse-native-linux-tools-in-their-attacks.html,attack.defense_evasion,"product: linux, service: None",,['Unknown'],,"{'selection': {'Image|endswith': 'crontab', 'CommandLine|contains': ' -r'}, 'condition': 'selection'}","Image=""*crontab"" CommandLine=""* -r*"""
proc_creation_lnx_pnscan_binary_cli_pattern.yml,Pnscan Binary Data Transmission Activity,97de11cd-4b67-4abf-9a8b-1020e670aa9e,"Detects command line patterns associated with the use of Pnscan for sending and receiving binary data across the network.
This behavior has been identified in a Linux malware campaign targeting Docker, Apache Hadoop, Redis, and Confluence and was previously used by the threat actor known as TeamTNT
",PNSCAN二元数据传输活动,"检测与使用PNSCAN在整个网络上发送和接收二进制数据相关的命令行模式。
该行为已在针对Docker，Apache Hadoop，Redis和Confluence的Linux恶意软件活动中确定",medium,"https://www.cadosecurity.com/blog/spinning-yarn-a-new-linux-malware-campaign-targets-docker-apache-hadoop-redis-and-confluence, https://intezer.com/wp-content/uploads/2021/09/TeamTNT-Cryptomining-Explosion.pdf, https://regex101.com/r/RugQYK/1, https://www.virustotal.com/gui/file/beddf70a7bab805f0c0b69ac0989db6755949f9f68525c08cb874988353f78a9/content","attack.discovery, attack.t1046","product: linux, service: None",,['Unknown'],,"{'selection': {'CommandLine|re': '-(W|R)\\s?(\\s|""|\')([0-9a-fA-F]{2}\\s?){2,20}(\\s|""|\')'}, 'condition': 'selection'}","*
| regex CommandLine=""-(W|R)\\s?(\\s|\""|')([0-9a-fA-F]{2}\\s?){2,20}(\\s|\""|')"""
proc_creation_lnx_crontab_enumeration.yml,Crontab Enumeration,403ed92c-b7ec-4edd-9947-5b535ee12d46,Detects usage of crontab to list the tasks of the user,克朗塔布枚举,检测Crontab的用法以列出用户的任务,low,"https://blogs.jpcert.or.jp/en/2023/05/gobrat.html, https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/, https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection, https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection","attack.discovery, attack.t1007","product: linux, service: None",,['Legitimate use of crontab'],,"{'selection': {'Image|endswith': '/crontab', 'CommandLine|contains': ' -l'}, 'condition': 'selection'}","Image=""*/crontab"" CommandLine=""* -l*"""
proc_creation_lnx_susp_execution_tmp_folder.yml,Potentially Suspicious Execution From Tmp Folder,312b42b1-bded-4441-8b58-163a3af58775,Detects a potentially suspicious execution of a process located in the '/tmp/' folder,从TMP文件夹中可能可疑执行,检测到'/tmp/'文件夹中的过程的潜在可疑执行,high,"https://blogs.jpcert.or.jp/en/2023/05/gobrat.html, https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/, https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection, https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection","attack.defense_evasion, attack.t1036","product: linux, service: None",,['Unknown'],,"{'selection': {'Image|startswith': '/tmp/'}, 'condition': 'selection'}","Image=""/tmp/*"""
proc_creation_lnx_doas_execution.yml,Linux Doas Tool Execution,067d8238-7127-451c-a9ec-fa78045b618b,"Detects the doas tool execution in linux host platform. This utility tool allow standard users to perform tasks as root, the same way sudo does.",Linux DOAS工具执行,在Linux主机平台中检测DOAS工具执行。该实用程序工具允许标准用户像苏多一样执行任务作为root。,low,"https://research.splunk.com/endpoint/linux_doas_tool_execution/, https://www.makeuseof.com/how-to-install-and-use-doas/","attack.privilege_escalation, attack.t1548","product: linux, service: None",,['Unlikely'],,"{'selection': {'Image|endswith': '/doas'}, 'condition': 'selection'}","Image=""*/doas"""
proc_creation_lnx_install_root_certificate.yml,Install Root Certificate,78a80655-a51e-4669-bc6b-e9d206a462ee,Detects installation of new certificate on the system which attackers may use to avoid warnings when connecting to controlled web servers or C2s,安装根证书,检测系统上新证书的安装,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1553.004/T1553.004.md,"attack.defense_evasion, attack.t1553.004","product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'Image|endswith': ['/update-ca-certificates', '/update-ca-trust']}, 'condition': 'selection'}","Image IN (""*/update-ca-certificates"", ""*/update-ca-trust"")"
proc_creation_lnx_services_stop_and_disable.yml,Disable Or Stop Services,de25eeb8-3655-4643-ac3a-b662d3f26b6b,"Detects the usage of utilities such as 'systemctl', 'service'...etc to stop or disable tools and services",禁用或停止服务,检测诸如“ SystemCtl”，“ Service”等公用事业的使用情况，以停止或禁用工具和服务,medium,https://www.trendmicro.com/pl_pl/research/20/i/the-evolution-of-malicious-shell-scripts.html,attack.defense_evasion,"product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'Image|endswith': ['/service', '/systemctl', '/chkconfig'], 'CommandLine|contains': ['stop', 'disable']}, 'condition': 'selection'}","Image IN (""*/service"", ""*/systemctl"", ""*/chkconfig"") CommandLine IN (""*stop*"", ""*disable*"")"
proc_creation_lnx_susp_hktl_execution.yml,Linux HackTool Execution,a015e032-146d-4717-8944-7a1884122111,Detects known hacktool execution based on image name.,Linux HackTool执行,根据图像名称检测已知的hackTool执行。,high,"https://github.com/Gui774ume/ebpfkit, https://github.com/pathtofile/bad-bpf, https://github.com/carlospolop/PEASS-ng, https://github.com/t3l3machus/hoaxshell, https://github.com/t3l3machus/Villain, https://github.com/HavocFramework/Havoc, https://github.com/1N3/Sn1per, https://github.com/Ne0nd0g/merlin, https://github.com/Pennyw0rth/NetExec/","attack.execution, attack.resource_development, attack.t1587","product: linux, service: None",,['Unlikely'],,"{'selection_c2_frameworks': {'Image|endswith': ['/crackmapexec', '/havoc', '/merlin-agent', '/merlinServer-Linux-x64', '/msfconsole', '/msfvenom', '/ps-empire server', '/ps-empire', '/sliver-client', '/sliver-server', '/Villain.py']}, 'selection_c2_framework_cobaltstrike': {'Image|contains': ['/cobaltstrike', '/teamserver']}, 'selection_scanners': {'Image|endswith': ['/autorecon', '/httpx', '/legion', '/naabu', '/netdiscover', '/nmap', '/nuclei', '/recon-ng', '/zenmap']}, 'selection_scanners_sniper': {'Image|contains': '/sniper'}, 'selection_web_enum': {'Image|endswith': ['/dirb', '/dirbuster', '/eyewitness', '/feroxbuster', '/ffuf', '/gobuster', '/wfuzz', '/whatweb']}, 'selection_web_vuln': {'Image|endswith': ['/joomscan', '/nikto', '/wpscan']}, 'selection_exploit_tools': {'Image|endswith': ['/aircrack-ng', '/bloodhound-python', '/bpfdos', '/ebpfki', '/evil-winrm', '/hashcat', '/hoaxshell.py', '/hydra', '/john', '/ncrack', '/nxc-ubuntu-latest', '/pidhide', '/pspy32', '/pspy32s', '/pspy64', '/pspy64s', '/setoolkit', '/sqlmap', '/writeblocker']}, 'selection_linpeas': {'Image|contains': '/linpeas'}, 'condition': '1 of selection_*'}","Image IN (""*/crackmapexec"", ""*/havoc"", ""*/merlin-agent"", ""*/merlinServer-Linux-x64"", ""*/msfconsole"", ""*/msfvenom"", ""*/ps-empire server"", ""*/ps-empire"", ""*/sliver-client"", ""*/sliver-server"", ""*/Villain.py"") OR Image IN (""*/cobaltstrike*"", ""*/teamserver*"") OR Image IN (""*/autorecon"", ""*/httpx"", ""*/legion"", ""*/naabu"", ""*/netdiscover"", ""*/nmap"", ""*/nuclei"", ""*/recon-ng"", ""*/zenmap"") OR Image=""*/sniper*"" OR Image IN (""*/dirb"", ""*/dirbuster"", ""*/eyewitness"", ""*/feroxbuster"", ""*/ffuf"", ""*/gobuster"", ""*/wfuzz"", ""*/whatweb"") OR Image IN (""*/joomscan"", ""*/nikto"", ""*/wpscan"") OR Image IN (""*/aircrack-ng"", ""*/bloodhound-python"", ""*/bpfdos"", ""*/ebpfki"", ""*/evil-winrm"", ""*/hashcat"", ""*/hoaxshell.py"", ""*/hydra"", ""*/john"", ""*/ncrack"", ""*/nxc-ubuntu-latest"", ""*/pidhide"", ""*/pspy32"", ""*/pspy32s"", ""*/pspy64"", ""*/pspy64s"", ""*/setoolkit"", ""*/sqlmap"", ""*/writeblocker"") OR Image=""*/linpeas*"""
proc_creation_lnx_netcat_reverse_shell.yml,Potential Netcat Reverse Shell Execution,7f734ed0-4f47-46c0-837f-6ee62505abd9,"Detects execution of netcat with the ""-e"" flag followed by common shells. This could be a sign of a potential reverse shell setup.",潜在的NetCat反向外壳执行,用“ -e”标志检测NETCAT的执行，然后是常见的外壳。这可能是潜在反向外壳设置的迹象。,high,"https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet, https://www.revshells.com/, https://www.hackingtutorials.org/networking/hacking-netcat-part-2-bind-reverse-shells/, https://www.infosecademy.com/netcat-reverse-shells/, https://man7.org/linux/man-pages/man1/ncat.1.html","attack.execution, attack.t1059","product: linux, service: None",,['Unlikely'],,"{'selection_nc': {'Image|endswith': ['/nc', '/ncat']}, 'selection_flags': {'CommandLine|contains': [' -c ', ' -e ']}, 'selection_shell': {'CommandLine|contains': [' ash', ' bash', ' bsh', ' csh', ' ksh', ' pdksh', ' sh', ' tcsh', '/bin/ash', '/bin/bash', '/bin/bsh', '/bin/csh', '/bin/ksh', '/bin/pdksh', '/bin/sh', '/bin/tcsh', '/bin/zsh', '$IFSash', '$IFSbash', '$IFSbsh', '$IFScsh', '$IFSksh', '$IFSpdksh', '$IFSsh', '$IFStcsh', '$IFSzsh']}, 'condition': 'all of selection_*'}","Image IN (""*/nc"", ""*/ncat"") CommandLine IN (""* -c *"", ""* -e *"") CommandLine IN (""* ash*"", ""* bash*"", ""* bsh*"", ""* csh*"", ""* ksh*"", ""* pdksh*"", ""* sh*"", ""* tcsh*"", ""*/bin/ash*"", ""*/bin/bash*"", ""*/bin/bsh*"", ""*/bin/csh*"", ""*/bin/ksh*"", ""*/bin/pdksh*"", ""*/bin/sh*"", ""*/bin/tcsh*"", ""*/bin/zsh*"", ""*$IFSash*"", ""*$IFSbash*"", ""*$IFSbsh*"", ""*$IFScsh*"", ""*$IFSksh*"", ""*$IFSpdksh*"", ""*$IFSsh*"", ""*$IFStcsh*"", ""*$IFSzsh*"")"
proc_creation_lnx_base64_shebang_cli.yml,Linux Base64 Encoded Shebang In CLI,fe2f9663-41cb-47e2-b954-8a228f3b9dff,"Detects the presence of a base64 version of the shebang in the commandline, which could indicate a malicious payload about to be decoded",Linux Base64编码CLI中的Shebang,检测命令行中Shebang的基本64版本的存在，这可能表明即将被解码的恶意有效载荷,medium,"https://www.trendmicro.com/pl_pl/research/20/i/the-evolution-of-malicious-shell-scripts.html, https://github.com/carlospolop/PEASS-ng/tree/master/linPEAS","attack.defense_evasion, attack.t1140","product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'CommandLine|contains': ['IyEvYmluL2Jhc2', 'IyEvYmluL2Rhc2', 'IyEvYmluL3pza', 'IyEvYmluL2Zpc2', 'IyEvYmluL3No']}, 'condition': 'selection'}","CommandLine IN (""*IyEvYmluL2Jhc2*"", ""*IyEvYmluL2Rhc2*"", ""*IyEvYmluL3pza*"", ""*IyEvYmluL2Zpc2*"", ""*IyEvYmluL3No*"")"
proc_creation_lnx_file_and_directory_discovery.yml,File and Directory Discovery - Linux,d3feb4ee-ff1d-4d3d-bd10-5b28a238cc72,Detects usage of system utilities to discover files and directories,文件和目录发现-Linux,检测系统实用程序的使用来发现文件和目录,informational,['https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1083/T1083.md'],"['attack.discovery', 'attack.t1083']","{'category': 'process_creation', 'product': 'linux'}",,['Legitimate activities'],ORing regular expressions is not yet supported by Splunk backend,"{'select_file_with_asterisk': {'Image|endswith': '/file', 'CommandLine|re': '(.){200,}'}, 'select_recursive_ls': {'Image|endswith': '/ls', 'CommandLine|contains': '-R'}, 'select_find_execution': {'Image|endswith': '/find'}, 'select_tree_execution': {'Image|endswith': '/tree'}, 'condition': '1 of select*'}",To Do
proc_creation_lnx_gtfobin_apt.yml,Apt GTFOBin Abuse - Linux,bb382fd5-b454-47ea-a264-1828e4c766d6,"Detects usage of ""apt"" and ""apt-get"" as a GTFOBin to execute and proxy command and binary execution",APT GTFOBIN滥用-Linux,检测使用“ APT”和“ APT-GEG”作为GTFOBIN的用法执行和代理命令和二进制执行,medium,"https://gtfobins.github.io/gtfobins/apt/, https://gtfobins.github.io/gtfobins/apt-get/","attack.discovery, attack.t1083","product: linux, service: None",,['Unknown'],,"{'selection': {'Image|endswith': ['/apt', '/apt-get'], 'CommandLine|contains': 'APT::Update::Pre-Invoke::='}, 'condition': 'selection'}","Image IN (""*/apt"", ""*/apt-get"") CommandLine=""*APT::Update::Pre-Invoke::=*"""
proc_creation_lnx_remote_access_tools_teamviewer_incoming_connection.yml,Remote Access Tool - Team Viewer Session Started On Linux Host,1f6b8cd4-3e60-47cc-b282-5aa1cbc9182d,"Detects the command line executed when TeamViewer starts a session started by a remote host.
Once a connection has been started, an investigator can verify the connection details by viewing the ""incoming_connections.txt"" log file in the TeamViewer folder.
",远程访问工具 - 团队查看器会话在Linux主机上启动,"检测由远程主机启动的TeamViewer启动会话时执行的命令行。
连接启动后，研究者可以通过查看TeamViewer文件夹中的“ incomming_connect.txt”日志文件来验证连接详细信息。",low,Internal Research,"attack.initial_access, attack.t1133","product: linux, service: None",,['Legitimate usage of TeamViewer'],,"{'selection': {'ParentImage|endswith': '/TeamViewer_Service', 'Image|endswith': '/TeamViewer_Desktop', 'CommandLine|endswith': '/TeamViewer_Desktop --IPCport 5939 --Module 1'}, 'condition': 'selection'}","ParentImage=""*/TeamViewer_Service"" Image=""*/TeamViewer_Desktop"" CommandLine=""*/TeamViewer_Desktop --IPCport 5939 --Module 1"""
proc_creation_lnx_python_pty_spawn.yml,Python Spawning Pretty TTY,c4042d54-110d-45dd-a0e1-05c47822c937,Detects python spawning a pretty tty which could be indicative of potential reverse shell activity,Python产卵漂亮的TTY,检测Python产卵的TTY，这可能表明潜在的反向外壳活动,high,https://www.volexity.com/blog/2022/06/02/zero-day-exploitation-of-atlassian-confluence/,"attack.execution, attack.t1059","product: linux, service: None",,['Unknown'],,"{'selection_img': [{'Image|endswith': ['/python', '/python2', '/python3']}, {'Image|contains': ['/python2.', '/python3.']}], 'selection_cli_1': {'CommandLine|contains|all': ['import pty', '.spawn(']}, 'selection_cli_2': {'CommandLine|contains': 'from pty import spawn'}, 'condition': 'selection_img and 1 of selection_cli_*'}","Image IN (""*/python"", ""*/python2"", ""*/python3"") OR Image IN (""*/python2.*"", ""*/python3.*"") (CommandLine=""*import pty*"" CommandLine=""*.spawn(*"") OR CommandLine=""*from pty import spawn*"""
proc_creation_lnx_esxcli_permission_change_admin.yml,ESXi Admin Permission Assigned To Account Via ESXCLI,9691f58d-92c1-4416-8bf3-2edd753ec9cf,"Detects execution of the ""esxcli"" command with the ""system"" and ""permission"" flags in order to assign admin permissions to an account.",通过ESXCLI分配了ESXI管理员的权限,通过“系统”和“权限”标志检测“ ESXCLI”命令的执行，以将管理员权限分配给帐户。,high,https://developer.vmware.com/docs/11743/esxi-7-0-esxcli-command-reference/namespace/esxcli_system.html,attack.execution,"product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'Image|endswith': '/esxcli', 'CommandLine|contains': 'system', 'CommandLine|contains|all': [' permission ', ' set', 'Admin']}, 'condition': 'selection'}","Image=""*/esxcli"" CommandLine=""*system*"" CommandLine=""* permission *"" CommandLine=""* set*"" CommandLine=""*Admin*"""
proc_creation_lnx_susp_sensitive_file_access.yml,Potential Suspicious Change To Sensitive/Critical Files,86157017-c2b1-4d4a-8c33-93b8e67e4af4,Detects changes of sensitive and critical files. Monitors files that you don't expect to change without planning on Linux system.,对敏感/关键文件的潜在可疑更改,检测敏感和关键文件的变化。在不计划Linux系统的情况下，监视您不会更改的文件。,medium,https://docs.microsoft.com/en-us/azure/defender-for-cloud/file-integrity-monitoring-overview#which-files-should-i-monitor,"attack.impact, attack.t1565.001","product: linux, service: None",,['Some false positives are to be expected on user or administrator machines. Apply additional filters as needed.'],,"{'selection_img_1': {'Image|endswith': ['/cat', '/echo', '/grep', '/head', '/more', '/tail'], 'CommandLine|contains': '>'}, 'selection_img_2': {'Image|endswith': ['/emacs', '/nano', '/sed', '/vi', '/vim']}, 'selection_paths': {'CommandLine|contains': ['/bin/login', '/bin/passwd', '/boot/', '/etc/*.conf', '/etc/cron.', '/etc/crontab', '/etc/hosts', '/etc/init.d', '/etc/sudoers', '/opt/bin/', '/sbin', '/usr/bin/', '/usr/local/bin/']}, 'condition': '1 of selection_img_* and selection_paths'}","(Image IN (""*/cat"", ""*/echo"", ""*/grep"", ""*/head"", ""*/more"", ""*/tail"") CommandLine=""*>*"") OR Image IN (""*/emacs"", ""*/nano"", ""*/sed"", ""*/vi"", ""*/vim"") CommandLine IN (""*/bin/login*"", ""*/bin/passwd*"", ""*/boot/*"", ""*/etc/*.conf*"", ""*/etc/cron.*"", ""*/etc/crontab*"", ""*/etc/hosts*"", ""*/etc/init.d*"", ""*/etc/sudoers*"", ""*/opt/bin/*"", ""*/sbin*"", ""*/usr/bin/*"", ""*/usr/local/bin/*"")"
proc_creation_lnx_gtfobin_vim.yml,Vim GTFOBin Abuse - Linux,7ab8f73a-fcff-428b-84aa-6a5ff7877dea,"Detects usage of ""vim"" and it's siblings as a GTFOBin to execute and proxy command and binary execution",VIM GTFOBIN滥用-Linux,检测“ vim”的用法，并且是兄弟姐妹作为gtfobin的执行和代理命令和二进制执行,high,"https://gtfobins.github.io/gtfobins/vim/, https://gtfobins.github.io/gtfobins/rvim/, https://gtfobins.github.io/gtfobins/vimdiff/","attack.discovery, attack.t1083","product: linux, service: None",,['Unknown'],,"{'selection_img': {'Image|endswith': ['/vim', '/rvim', '/vimdiff'], 'CommandLine|contains': [' -c ', ' --cmd']}, 'selection_cli': {'CommandLine|contains': [':!/', ':py ', ':lua ', '/bin/sh', '/bin/bash', '/bin/dash', '/bin/zsh', '/bin/fish']}, 'condition': 'all of selection_*'}","Image IN (""*/vim"", ""*/rvim"", ""*/vimdiff"") CommandLine IN (""* -c *"", ""* --cmd*"") CommandLine IN (""*:!/*"", ""*:py *"", ""*:lua *"", ""*/bin/sh*"", ""*/bin/bash*"", ""*/bin/dash*"", ""*/bin/zsh*"", ""*/bin/fish*"")"
proc_creation_lnx_susp_curl_useragent.yml,Suspicious Curl Change User Agents - Linux,b86d356d-6093-443d-971c-9b07db583c68,Detects a suspicious curl process start on linux with set useragent options,可疑的卷发更改用户代理-Linux,检测一个可疑的卷曲过程在Linux上开始使用SET用户Apote,medium,https://curl.se/docs/manpage.html,"attack.command_and_control, attack.t1071.001","product: linux, service: None",,"['Scripts created by developers and admins', 'Administrative activity']",,"{'selection': {'Image|endswith': '/curl', 'CommandLine|contains': [' -A ', ' --user-agent ']}, 'condition': 'selection'}","Image=""*/curl"" CommandLine IN (""* -A *"", ""* --user-agent *"")"
proc_creation_lnx_clear_syslog.yml,Commands to Clear or Remove the Syslog,3fcc9b35-39e4-44c0-a2ad-9e82b6902b31,Detects specific commands commonly used to remove or empty the syslog. Which is often used by attacker as a method to hide their tracks,命令清除或删除Syslog,检测通常用于删除或清空Syslog的特定命令。攻击者通常将其用作隐藏轨道的方法,high,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.002/T1070.002.md,"attack.defense_evasion, attack.t1070.002","product: linux, service: None",,['Log rotation.'],,"{'selection': {'CommandLine|contains': ['rm /var/log/syslog', 'rm -r /var/log/syslog', 'rm -f /var/log/syslog', 'rm -rf /var/log/syslog', 'unlink /var/log/syslog', 'unlink -r /var/log/syslog', 'unlink -f /var/log/syslog', 'unlink -rf /var/log/syslog', 'mv /var/log/syslog', ' >/var/log/syslog', ' > /var/log/syslog']}, 'condition': 'selection'}","CommandLine IN (""*rm /var/log/syslog*"", ""*rm -r /var/log/syslog*"", ""*rm -f /var/log/syslog*"", ""*rm -rf /var/log/syslog*"", ""*unlink /var/log/syslog*"", ""*unlink -r /var/log/syslog*"", ""*unlink -f /var/log/syslog*"", ""*unlink -rf /var/log/syslog*"", ""*mv /var/log/syslog*"", ""* >/var/log/syslog*"", ""* > /var/log/syslog*"")"
proc_creation_lnx_security_software_discovery.yml,Security Software Discovery - Linux,c9d8b7fd-78e4-44fe-88f6-599135d46d60,Detects usage of system utilities (only grep and egrep for now) to discover security software discovery,安全软件发现-Linux,检测系统实用程序的使用（目前仅GREP和EGREP）来发现安全软件发现,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1518.001/T1518.001.md,"attack.discovery, attack.t1518.001","product: linux, service: None",,['Legitimate activities'],,"{'selection': {'Image|endswith': ['/grep', '/egrep'], 'CommandLine|contains': ['nessusd', 'td-agent', 'packetbeat', 'filebeat', 'auditbeat', 'osqueryd', 'cbagentd', 'falcond']}, 'condition': 'selection'}","Image IN (""*/grep"", ""*/egrep"") CommandLine IN (""*nessusd*"", ""*td-agent*"", ""*packetbeat*"", ""*filebeat*"", ""*auditbeat*"", ""*osqueryd*"", ""*cbagentd*"", ""*falcond*"")"
proc_creation_lnx_wget_download_suspicious_directory.yml,Download File To Potentially Suspicious Directory Via Wget,cf610c15-ed71-46e1-bdf8-2bd1a99de6c4,Detects the use of wget to download content to a suspicious directory,通过WGET将文件下载到潜在的可疑目录,检测使用WGET将内容下载到可疑目录,medium,"['https://blogs.jpcert.or.jp/en/2023/05/gobrat.html', 'https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/', 'https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection', 'https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection']","['attack.command_and_control', 'attack.t1105']","{'category': 'process_creation', 'product': 'linux'}",,['Unknown'],ORing regular expressions is not yet supported by Splunk backend,"{'selection_img': {'Image|endswith': '/wget'}, 'selection_output': [{'CommandLine|re': '\\s-O\\s'}, {'CommandLine|contains': '--output-document'}], 'selection_path': {'CommandLine|contains': '/tmp/'}, 'condition': 'all of selection_*'}",To Do
proc_creation_lnx_python_reverse_shell.yml,Potential Python Reverse Shell,32e62bc7-3de0-4bb1-90af-532978fe42c0,Detects executing python with keywords related to network activity that could indicate a potential reverse shell,潜在的Python反向外壳,检测使用与网络活动相关的关键字执行Python，这可能表明潜在的反向外壳,high,"https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet, https://www.revshells.com/",attack.execution,"product: linux, service: None",,['Unknown'],,"{'selection': {'Image|contains': 'python', 'CommandLine|contains|all': [' -c ', 'import', 'pty', 'spawn(', '.connect']}, 'condition': 'selection'}","Image=""*python*"" CommandLine=""* -c *"" CommandLine=""*import*"" CommandLine=""*pty*"" CommandLine=""*spawn(*"" CommandLine=""*.connect*"""
proc_creation_lnx_cp_passwd_or_shadow_tmp.yml,Copy Passwd Or Shadow From TMP Path,fa4aaed5-4fe0-498d-bbc0-08e3346387ba,"Detects when the file ""passwd"" or ""shadow"" is copied from tmp path",从TMP路径复制PassWD或阴影,检测何时从TMP路径复制文件“ PassWD”或“ Shadow”,high,"https://blogs.blackberry.com/, https://twitter.com/Joseliyo_Jstnk/status/1620131033474822144","attack.credential_access, attack.t1552.001","product: linux, service: None",,['Unknown'],,"{'selection_img': {'Image|endswith': '/cp'}, 'selection_path': {'CommandLine|contains': '/tmp/'}, 'selection_file': {'CommandLine|contains': ['passwd', 'shadow']}, 'condition': 'all of selection_*'}","Image=""*/cp"" CommandLine=""*/tmp/*"" CommandLine IN (""*passwd*"", ""*shadow*"")"
proc_creation_lnx_clear_logs.yml,Clear Linux Logs,80915f59-9b56-4616-9de0-fd0dea6c12fe,Detects attempts to clear logs on the system. Adversaries may clear system logs to hide evidence of an intrusion,清除Linux日志,检测试图清除系统上的日志。对手可能会清除系统日志以隐藏入侵的证据,medium,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.002/T1070.002.md,"attack.defense_evasion, attack.t1070.002","product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'Image|endswith': ['/rm', '/shred', '/unlink'], 'CommandLine|contains': ['/var/log', '/var/spool/mail']}, 'condition': 'selection'}","Image IN (""*/rm"", ""*/shred"", ""*/unlink"") CommandLine IN (""*/var/log*"", ""*/var/spool/mail*"")"
proc_creation_lnx_file_deletion.yml,File Deletion,30aed7b6-d2c1-4eaf-9382-b6bc43e50c57,"Detects file deletion using ""rm"", ""shred"" or ""unlink"" commands which are used often by adversaries to delete files left behind by the actions of their intrusion activity",文件删除,使用“ RM”，“切碎”或“ UNLINK”命令检测文件删除，这些命令经常被对手使用，以删除由其入侵活动的动作留下的文件,informational,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.004/T1070.004.md,"attack.defense_evasion, attack.t1070.004","product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'Image|endswith': ['/rm', '/shred', '/unlink']}, 'condition': 'selection'}","Image IN (""*/rm"", ""*/shred"", ""*/unlink"")"
proc_creation_lnx_susp_network_utilities_execution.yml,Linux Network Service Scanning Tools Execution,3e102cd9-a70d-4a7a-9508-403963092f31,Detects execution of network scanning and reconnaisance tools. These tools can be used for the enumeration of local or remote network services for example.,Linux网络服务扫描工具执行,检测网络扫描和侦察工具的执行。这些工具可用于列举本地或远程网络服务。,low,"https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1046/T1046.md, https://github.com/projectdiscovery/naabu, https://github.com/Tib3rius/AutoRecon","attack.discovery, attack.t1046","product: linux, service: None",,['Legitimate administration activities'],,"{'selection_netcat': {'Image|endswith': ['/nc', '/ncat', '/netcat', '/socat']}, 'selection_network_scanning_tools': {'Image|endswith': ['/autorecon', '/hping', '/hping2', '/hping3', '/naabu', '/nmap', '/nping', '/telnet']}, 'filter_main_netcat_listen_flag': {'CommandLine|contains': [' --listen ', ' -l ']}, 'condition': '(selection_netcat and not filter_main_netcat_listen_flag) or selection_network_scanning_tools'}","(Image IN (""*/nc"", ""*/ncat"", ""*/netcat"", ""*/socat"") NOT (CommandLine IN (""* --listen *"", ""* -l *""))) OR Image IN (""*/autorecon"", ""*/hping"", ""*/hping2"", ""*/hping3"", ""*/naabu"", ""*/nmap"", ""*/nping"", ""*/telnet"")"
proc_creation_lnx_susp_inod_listing.yml,Potential Container Discovery Via Inodes Listing,43e26eb5-cd58-48d1-8ce9-a273f5d298d8,"Detects listing of the inodes of the ""/"" directory to determine if the we are running inside of a container.",通过inodes列表发现潜在的容器,检测“/”目录的indodes的清单，以确定我们是否在容器内部运行。,low,"https://blog.skyplabs.net/posts/container-detection/, https://stackoverflow.com/questions/20010199/how-to-determine-if-a-process-runs-inside-lxc-docker","attack.discovery, attack.t1082","product: linux, service: None",,"['Legitimate system administrator usage of these commands', 'Some container tools or deployments may use these techniques natively to determine how they proceed with execution, and will need to be filtered']",,"{'selection': {'Image|endswith': '/ls', 'CommandLine|contains|all': [' -*i', ' -*d'], 'CommandLine|endswith': ' /'}, 'condition': 'selection'}","Image=""*/ls"" CommandLine=""* -*i*"" CommandLine=""* -*d*"" CommandLine=""* /"""
proc_creation_lnx_susp_dockerenv_recon.yml,Docker Container Discovery Via Dockerenv Listing,11701de9-d5a5-44aa-8238-84252f131895,"Detects listing or file reading of "".dockerenv"" which can be a sing of potential container discovery",Docker Container通过DockErenv列表发现,检测“ .dockerenv”的清单或文件读数，这可能是潜在容器发现的唱片,low,"https://blog.skyplabs.net/posts/container-detection/, https://stackoverflow.com/questions/20010199/how-to-determine-if-a-process-runs-inside-lxc-docker","attack.discovery, attack.t1082","product: linux, service: None",,"['Legitimate system administrator usage of these commands', 'Some container tools or deployments may use these techniques natively to determine how they proceed with execution, and will need to be filtered']",,"{'selection': {'Image|endswith': ['/cat', '/dir', '/find', '/ls', '/stat', '/test', 'grep'], 'CommandLine|endswith': '.dockerenv'}, 'condition': 'selection'}","Image IN (""*/cat"", ""*/dir"", ""*/find"", ""*/ls"", ""*/stat"", ""*/test"", ""*grep"") CommandLine=""*.dockerenv"""
proc_creation_lnx_susp_git_clone.yml,Suspicious Git Clone - Linux,cfec9d29-64ec-4a0f-9ffe-0fdb856d5446,"Detects execution of ""git"" in order to clone a remote repository that contain suspicious keywords which might be suspicious",可疑的git克隆-Linux,检测“ git”的执行，以克隆一个远程存储库，其中包含可疑关键字的远程存储库,medium,https://gist.githubusercontent.com/MichaelKoczwara/12faba9c061c12b5814b711166de8c2f/raw/e2068486692897b620c25fde1ea258c8218fe3d3/history.txt,"attack.reconnaissance, attack.t1593.003","product: linux, service: None",,['Unknown'],,"{'selection_img': {'Image|endswith': '/git', 'CommandLine|contains': ' clone '}, 'selection_keyword': {'CommandLine|contains': ['exploit', 'Vulns', 'vulnerability', 'RCE', 'RemoteCodeExecution', 'Invoke-', 'CVE-', 'poc-', 'ProofOfConcept', 'proxyshell', 'log4shell', 'eternalblue', 'eternal-blue', 'MS17-']}, 'condition': 'all of selection_*'}","Image=""*/git"" CommandLine=""* clone *"" CommandLine IN (""*exploit*"", ""*Vulns*"", ""*vulnerability*"", ""*RCE*"", ""*RemoteCodeExecution*"", ""*Invoke-*"", ""*CVE-*"", ""*poc-*"", ""*ProofOfConcept*"", ""*proxyshell*"", ""*log4shell*"", ""*eternalblue*"", ""*eternal-blue*"", ""*MS17-*"")"
proc_creation_lnx_bpf_kprob_tracing_enabled.yml,Enable BPF Kprobes Tracing,7692f583-bd30-4008-8615-75dab3f08a99,Detects common command used to enable bpf kprobes tracing,启用BPF Kprobes跟踪,检测用于启用BPF Kprobes跟踪的公共命令,medium,"https://embracethered.com/blog/posts/2021/offensive-bpf-bpftrace/, https://bpftrace.org/, https://www.kernel.org/doc/html/v5.0/trace/kprobetrace.html","attack.execution, attack.defense_evasion","product: linux, service: None",,['Unknown'],,"{'selection': {'CommandLine|contains|all': ['echo 1 >', '/sys/kernel/debug/tracing/events/kprobes/'], 'CommandLine|contains': ['/myprobe/enable', '/myretprobe/enable']}, 'condition': 'selection'}","CommandLine=""*echo 1 >*"" CommandLine=""*/sys/kernel/debug/tracing/events/kprobes/*"" CommandLine IN (""*/myprobe/enable*"", ""*/myretprobe/enable*"")"
proc_creation_lnx_bash_interactive_shell.yml,Bash Interactive Shell,6104e693-a7d6-4891-86cb-49a258523559,"Detects execution of the bash shell with the interactive flag ""-i"".",bash互动外壳,用交互式标志“ -i”检测bash壳的执行。,low,"https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet, https://www.revshells.com/, https://linux.die.net/man/1/bash",attack.execution,"product: linux, service: None",,['Unknown'],,"{'selection': {'Image|endswith': '/bash', 'CommandLine|contains': ' -i '}, 'condition': 'selection'}","Image=""*/bash"" CommandLine=""* -i *"""
proc_creation_lnx_grep_os_arch_discovery.yml,OS Architecture Discovery Via Grep,d27ab432-2199-483f-a297-03633c05bae6,"Detects the use of grep to identify information about the operating system architecture. Often combined beforehand with the execution of ""uname"" or ""cat /proc/cpuinfo""
",OS架构发现通过GREP,检测使用GREP来识别有关操作系统体系结构的信息。通常事先与执行“ uname”或“ cat /proc /cpuinfo”结合在一起,low,"https://blogs.jpcert.or.jp/en/2023/05/gobrat.html, https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/, https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection, https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection","attack.discovery, attack.t1082","product: linux, service: None",,['Unknown'],,"{'selection_process': {'Image|endswith': '/grep'}, 'selection_architecture': {'CommandLine|endswith': ['aarch64', 'arm', 'i386', 'i686', 'mips', 'x86_64']}, 'condition': 'all of selection_*'}","Image=""*/grep"" CommandLine IN (""*aarch64"", ""*arm"", ""*i386"", ""*i686"", ""*mips"", ""*x86_64"")"
proc_creation_lnx_susp_shell_script_exec_from_susp_location.yml,Execution Of Script Located In Potentially Suspicious Directory,30bcce26-51c5-49f2-99c8-7b59e3af36c7,"Detects executions of scripts located in potentially suspicious locations such as ""/tmp"" via a shell such as ""bash"", ""sh"", etc.",执行位于潜在可疑目录中的脚本,检测到可能可疑位置中的脚本执行，例如“/tmp”，例如“ bash”，“ sh”等。,medium,"https://blogs.jpcert.or.jp/en/2023/05/gobrat.html, https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/, https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection, https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection",attack.execution,"product: linux, service: None",,['Unknown'],,"{'selection_img': {'Image|endswith': ['/bash', '/csh', '/dash', '/fish', '/ksh', '/sh', '/zsh']}, 'selection_flag': {'CommandLine|contains': ' -c '}, 'selection_paths': {'CommandLine|contains': '/tmp/'}, 'condition': 'all of selection_*'}","Image IN (""*/bash"", ""*/csh"", ""*/dash"", ""*/fish"", ""*/ksh"", ""*/sh"", ""*/zsh"") CommandLine=""* -c *"" CommandLine=""*/tmp/*"""
proc_creation_lnx_userdel.yml,User Has Been Deleted Via Userdel,08f26069-6f80-474b-8d1f-d971c6fedea0,"Detects execution of the ""userdel"" binary. Which is used to delete a user account and related files. This is sometimes abused by threat actors in order to cover their tracks",用户已通过UserDel删除,检测“ UserDel”二进制的执行。用于删除用户帐户和相关文件。有时威胁参与者滥用这是为了掩盖他们的轨道,medium,"https://linuxize.com/post/how-to-delete-group-in-linux/, https://www.cyberciti.biz/faq/linux-remove-user-command/, https://www.cybrary.it/blog/0p3n/linux-commands-used-attackers/, https://linux.die.net/man/8/userdel","attack.impact, attack.t1531","product: linux, service: None",,['Legitimate administrator activities'],,"{'selection': {'Image|endswith': '/userdel'}, 'condition': 'selection'}","Image=""*/userdel"""
proc_creation_lnx_cve_2022_26134_atlassian_confluence.yml,Atlassian Confluence CVE-2022-26134,7fb14105-530e-4e2e-8cfb-99f7d8700b66,Detects spawning of suspicious child processes by Atlassian Confluence server which may indicate successful exploitation of CVE-2022-26134,Atlassian Confluence CVE-2022-26134,检测Atlassian Confluence Server对可疑的儿童流程的产卵，这可能表明CVE-2022-26134成功开发,high,https://www.volexity.com/blog/2022/06/02/zero-day-exploitation-of-atlassian-confluence/,"attack.initial_access, attack.execution, attack.t1190, attack.t1059, cve.2022.26134","product: linux, service: None",,['Unknown'],,"{'selection': {'ParentImage|startswith': '/opt/atlassian/confluence/', 'ParentImage|endswith': '/java', 'CommandLine|contains': ['/bin/sh', 'bash', 'dash', 'ksh', 'zsh', 'csh', 'fish', 'curl', 'wget', 'python']}, 'condition': 'selection'}","ParentImage=""/opt/atlassian/confluence/*"" ParentImage=""*/java"" CommandLine IN (""*/bin/sh*"", ""*bash*"", ""*dash*"", ""*ksh*"", ""*zsh*"", ""*csh*"", ""*fish*"", ""*curl*"", ""*wget*"", ""*python*"")"
proc_creation_lnx_base64_execution.yml,Linux Base64 Encoded Pipe to Shell,ba592c6d-6888-43c3-b8c6-689b8fe47337,Detects suspicious process command line that uses base64 encoded input for execution with a shell,Linux base64编码的管道到外壳,检测可疑的过程命令行，该命令使用base64编码输入用外壳执行,medium,"https://github.com/arget13/DDexec, https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally","attack.defense_evasion, attack.t1140","product: linux, service: None",,['Legitimate administration activities'],,"{'selection_base64': {'CommandLine|contains': 'base64 '}, 'selection_exec': [{'CommandLine|contains': ['| bash ', '| sh ', '|bash ', '|sh ']}, {'CommandLine|endswith': [' |sh', '| bash', '| sh', '|bash']}], 'condition': 'all of selection_*'}","CommandLine=""*base64 *"" CommandLine IN (""*| bash *"", ""*| sh *"", ""*|bash *"", ""*|sh *"") OR CommandLine IN (""* |sh"", ""*| bash"", ""*| sh"", ""*|bash"")"
proc_creation_lnx_webshell_detection.yml,Linux Webshell Indicators,818f7b24-0fba-4c49-a073-8b755573b9c7,Detects suspicious sub processes of web server processes,Linux Webshel​​l指标,检测Web服务器进程的可疑子进程,high,"https://www.acunetix.com/blog/articles/web-shells-101-using-php-introduction-web-shells-part-2/, https://media.defense.gov/2020/Jun/09/2002313081/-1/-1/0/CSI-DETECT-AND-PREVENT-WEB-SHELL-MALWARE-20200422.PDF","attack.persistence, attack.t1505.003","product: linux, service: None",,['Web applications that invoke Linux command line tools'],,"{'selection_general': {'ParentImage|endswith': ['/httpd', '/lighttpd', '/nginx', '/apache2', '/node', '/caddy']}, 'selection_tomcat': {'ParentCommandLine|contains|all': ['/bin/java', 'tomcat']}, 'selection_websphere': {'ParentCommandLine|contains|all': ['/bin/java', 'websphere']}, 'sub_processes': {'Image|endswith': ['/whoami', '/ifconfig', '/ip', '/bin/uname', '/bin/cat', '/bin/crontab', '/hostname', '/iptables', '/netstat', '/pwd', '/route']}, 'condition': '1 of selection_* and sub_processes'}","ParentImage IN (""*/httpd"", ""*/lighttpd"", ""*/nginx"", ""*/apache2"", ""*/node"", ""*/caddy"") OR (ParentCommandLine=""*/bin/java*"" ParentCommandLine=""*tomcat*"") OR (ParentCommandLine=""*/bin/java*"" ParentCommandLine=""*websphere*"") Image IN (""*/whoami"", ""*/ifconfig"", ""*/ip"", ""*/bin/uname"", ""*/bin/cat"", ""*/bin/crontab"", ""*/hostname"", ""*/iptables"", ""*/netstat"", ""*/pwd"", ""*/route"")"
proc_creation_lnx_omigod_scx_runasprovider_executeshellcommand.yml,OMIGOD SCX RunAsProvider ExecuteShellCommand,21541900-27a9-4454-9c4c-3f0a4240344a,"Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand to execute any UNIX/Linux command using the /bin/sh shell.
SCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including
Microsoft Operations Manager, Microsoft Azure, and Microsoft Operations Management Suite.
",Omigod SCX runasProvider执行ExecuteshellCommand,"规则以检测使用SCX RunasProvider Invoke_executeshellCommand使用/bin/sh shell执行任何UNIX/Linux命令。
SCXCORE最初是Microsoft Operations Manager Unix/Linux代理，现在用于许多产品，包括
Microsoft Operations Manager，Microsoft Azure和Microsoft Operations Management Suite。",high,"https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure, https://github.com/Azure/Azure-Sentinel/pull/3059","attack.privilege_escalation, attack.initial_access, attack.execution, attack.t1068, attack.t1190, attack.t1203","product: linux, service: None",,['Legitimate use of SCX RunAsProvider Invoke_ExecuteShellCommand.'],,"{'selection': {'User': 'root', 'LogonId': 0, 'CurrentDirectory': '/var/opt/microsoft/scx/tmp', 'CommandLine|contains': '/bin/sh'}, 'condition': 'selection'}","User=""root"" LogonId=0 CurrentDirectory=""/var/opt/microsoft/scx/tmp"" CommandLine=""*/bin/sh*"""
proc_creation_lnx_nohup_susp_execution.yml,Suspicious Nohup Execution,457df417-8b9d-4912-85f3-9dbda39c3645,"Detects execution of binaries located in potentially suspicious locations via ""nohup""",可疑的NOHUP执行,检测通过“ NOHUP”处执行位于潜在可疑位置的二进制文件,high,"https://blogs.jpcert.or.jp/en/2023/05/gobrat.html, https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/, https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection, https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection",attack.execution,"product: linux, service: None",,['Unknown'],,"{'selection': {'Image|endswith': '/nohup', 'CommandLine|contains': '/tmp/'}, 'condition': 'selection'}","Image=""*/nohup"" CommandLine=""*/tmp/*"""
proc_creation_lnx_php_reverse_shell.yml,Potential PHP Reverse Shell,c6714a24-d7d5-4283-a36b-3ffd091d5f7e,"Detects usage of the PHP CLI with the ""-r"" flag which allows it to run inline PHP code. The rule looks for calls to the ""fsockopen"" function which allows the creation of sockets.
Attackers often leverage this in combination with functions such as ""exec"" or ""fopen"" to initiate a reverse shell connection.
",潜在的PHP反向外壳,"使用“ -r”标志检测PHP CLI的用法，该标志允许其运行内联PHP代码。该规则寻找允许创建插座的“ fsockopen”功能的调用。
攻击者通常将其与“ Exec”或“ Fopen”之类的功能结合起来来启动反向外壳连接。",high,"https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet, https://www.revshells.com/",attack.execution,"product: linux, service: None",,['Unknown'],,"{'selection': {'Image|contains': '/php', 'CommandLine|contains|all': [' -r ', 'fsockopen'], 'CommandLine|contains': ['ash', 'bash', 'bsh', 'csh', 'ksh', 'pdksh', 'sh', 'tcsh', 'zsh']}, 'condition': 'selection'}","Image=""*/php*"" CommandLine=""* -r *"" CommandLine=""*fsockopen*"" CommandLine IN (""*ash*"", ""*bash*"", ""*bsh*"", ""*csh*"", ""*ksh*"", ""*pdksh*"", ""*sh*"", ""*tcsh*"", ""*zsh*"")"
proc_creation_lnx_susp_curl_fileupload.yml,Suspicious Curl File Upload - Linux,00b90cc1-17ec-402c-96ad-3a8117d7a582,Detects a suspicious curl process start the adds a file to a web request,可疑的卷发文件上传-Linux,检测一个可疑的卷曲过程启动将文件添加到Web请求,medium,"['https://twitter.com/d1r4c/status/1279042657508081664', 'https://medium.com/@petehouston/upload-files-with-curl-93064dcccc76', 'https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1105/T1105.md#atomic-test-19---curl-upload-file', 'https://curl.se/docs/manpage.html', 'https://www.trendmicro.com/en_us/research/22/i/how-malicious-actors-abuse-native-linux-tools-in-their-attacks.html']","['attack.exfiltration', 'attack.t1567', 'attack.t1105']","{'category': 'process_creation', 'product': 'linux'}",,['Scripts created by developers and admins'],ORing regular expressions is not yet supported by Splunk backend,"{'selection_img': {'Image|endswith': '/curl'}, 'selection_cli': [{'CommandLine|contains': [' --form', ' --upload-file ', ' --data ', ' --data-']}, {'CommandLine|re': '\\s-[FTd]\\s'}], 'filter_optional_localhost': {'CommandLine|contains': ['://localhost', '://127.0.0.1']}, 'condition': 'all of selection_* and not 1 of filter_optional_*'}",To Do
proc_creation_lnx_esxcli_system_discovery.yml,ESXi System Information Discovery Via ESXCLI,e80273e1-9faf-40bc-bd85-dbaff104c4e9,"Detects execution of the ""esxcli"" command with the ""system"" flag in order to retrieve information about the different component of the system. Such as accounts, modules, NTP, etc.",ESXI系统信息通过ESXCLI发现,检测具有“系统”标志的“ ESXCLI”命令的执行，以检索有关系统不同组件的信息。例如帐户，模块，NTP等。,medium,"https://www.crowdstrike.com/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/, https://developer.vmware.com/docs/11743/esxi-7-0-esxcli-command-reference/namespace/esxcli_system.html","attack.discovery, attack.t1033, attack.t1007","product: linux, service: None",,['Legitimate administration activities'],,"{'selection_img': {'Image|endswith': '/esxcli', 'CommandLine|contains': 'system'}, 'selection_cli': {'CommandLine|contains': [' get', ' list']}, 'condition': 'all of selection_*'}","Image=""*/esxcli"" CommandLine=""*system*"" CommandLine IN (""* get*"", ""* list*"")"
proc_creation_lnx_nohup.yml,Nohup Execution,e4ffe466-6ff8-48d4-94bd-e32d1a6061e2,Detects usage of nohup which could be leveraged by an attacker to keep a process running or break out from restricted environments,执行NOHUP,检测攻击者可以利用的NOHUP的用法，以使过程运行或脱离受限环境,medium,"https://gtfobins.github.io/gtfobins/nohup/, https://en.wikipedia.org/wiki/Nohup, https://www.computerhope.com/unix/unohup.htm","attack.execution, attack.t1059.004","product: linux, service: None",,['Administrators or installed processes that leverage nohup'],,"{'selection': {'Image|endswith': '/nohup'}, 'condition': 'selection'}","Image=""*/nohup"""
proc_creation_lnx_mkfifo_named_pipe_creation_susp_location.yml,Potentially Suspicious Named Pipe Created Via Mkfifo,999c3b12-0a8c-40b6-8e13-dd7d62b75c7a,"Detects the creation of a new named pipe using the ""mkfifo"" utility in a potentially suspicious location",通过MKFIFO创建的潜在可疑命名管,在潜在可疑的位置检测使用“ MKFIFO”实用程序的新名称管道的创建,medium,"https://dev.to/0xbf/use-mkfifo-to-create-named-pipe-linux-tips-5bbk, https://www.mandiant.com/resources/blog/barracuda-esg-exploited-globally",attack.execution,"product: linux, service: None",,['Unknown'],,"{'selection': {'Image|endswith': '/mkfifo', 'CommandLine|contains': ' /tmp/'}, 'condition': 'selection'}","Image=""*/mkfifo"" CommandLine=""* /tmp/*"""
proc_creation_lnx_susp_find_execution.yml,Potential Discovery Activity Using Find - Linux,8344c0e5-5783-47cc-9cf9-a0f7fd03e6cf,"Detects usage of ""find"" binary in a suspicious manner to perform discovery",使用查找的潜在发现活动-Linux,以可疑的方式检测“查找”二进制的用法进行发现,medium,https://github.com/SaiSathvik1/Linux-Privilege-Escalation-Notes,"attack.discovery, attack.t1083","product: linux, service: None",,['Unknown'],,"{'selection': {'Image|endswith': '/find', 'CommandLine|contains': ['-perm -4000', '-perm -2000', '-perm 0777', '-perm -222', '-perm -o w', '-perm -o x', '-perm -u=s', '-perm -g=s']}, 'condition': 'selection'}","Image=""*/find"" CommandLine IN (""*-perm -4000*"", ""*-perm -2000*"", ""*-perm 0777*"", ""*-perm -222*"", ""*-perm -o w*"", ""*-perm -o x*"", ""*-perm -u=s*"", ""*-perm -g=s*"")"
proc_creation_lnx_ruby_reverse_shell.yml,Potential Ruby Reverse Shell,b8bdac18-c06e-4016-ac30-221553e74f59,"Detects execution of ruby with the ""-e"" flag and calls to ""socket"" related functions. This could be an indication of a potential attempt to setup a reverse shell",潜在红宝石反向外壳,用“ -e”标志检测Ruby的执行，并调用“套接字”相关功能。这可能表明可能试图设置反向外壳,medium,"https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet, https://www.revshells.com/",attack.execution,"product: linux, service: None",,['Unknown'],,"{'selection': {'Image|contains': 'ruby', 'CommandLine|contains|all': [' -e', 'rsocket', 'TCPSocket'], 'CommandLine|contains': [' ash', ' bash', ' bsh', ' csh', ' ksh', ' pdksh', ' sh', ' tcsh']}, 'condition': 'selection'}","Image=""*ruby*"" CommandLine=""* -e*"" CommandLine=""*rsocket*"" CommandLine=""*TCPSocket*"" CommandLine IN (""* ash*"", ""* bash*"", ""* bsh*"", ""* csh*"", ""* ksh*"", ""* pdksh*"", ""* sh*"", ""* tcsh*"")"
proc_creation_lnx_kill_process.yml,Terminate Linux Process Via Kill,64c41342-6b27-523b-5d3f-c265f3efcdb3,"Detects usage of command line tools such as ""kill"", ""pkill"" or ""killall"" to terminate or signal a running process.",通过杀死终止Linux过程,检测命令行工具（例如“ Kill”，“ Pkill”或“ Killall”）的用法以终止或发出运行过程。,low,"https://www.trendmicro.com/en_us/research/23/c/iron-tiger-sysupdate-adds-linux-targeting.html, https://www.cyberciti.biz/faq/how-force-kill-process-linux/","attack.defense_evasion, attack.t1562","product: linux, service: None",,['Likely'],,"{'selection': {'Image|endswith': ['/kill', '/pkill', '/killall']}, 'condition': 'selection'}","Image IN (""*/kill"", ""*/pkill"", ""*/killall"")"
proc_creation_lnx_schedule_task_job_cron.yml,Scheduled Cron Task/Job - Linux,6b14bac8-3e3a-4324-8109-42f0546a347f,Detects abuse of the cron utility to perform task scheduling for initial or recurring execution of malicious code. Detection will focus on crontab jobs uploaded from the tmp folder.,计划的CRON任务/作业-Linux,检测滥用Cron实用程序以执行任务计划，以初始或重复执行恶意代码。检测将集中于从TMP文件夹上传的crontab作业。,medium,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1053.003/T1053.003.md,"attack.execution, attack.persistence, attack.privilege_escalation, attack.t1053.003","product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'Image|endswith': 'crontab', 'CommandLine|contains': '/tmp/'}, 'condition': 'selection'}","Image=""*crontab"" CommandLine=""*/tmp/*"""
proc_creation_lnx_iptables_flush_ufw.yml,Flush Iptables Ufw Chain,3be619f4-d9ec-4ea8-a173-18fdd01996ab,"Detect use of iptables to flush all firewall rules, tables and chains and allow all network traffic",冲洗iptables UFW链,检测使用iptables来冲洗所有防火墙规则，表格和链条，并允许所有网络流量,medium,"https://blogs.blackberry.com/, https://www.cyberciti.biz/tips/linux-iptables-how-to-flush-all-rules.html, https://twitter.com/Joseliyo_Jstnk/status/1620131033474822144","attack.defense_evasion, attack.t1562.004","product: linux, service: None",,['Network administrators'],,"{'selection_img': {'Image|endswith': ['/iptables', '/xtables-legacy-multi', '/iptables-legacy-multi', '/ip6tables', '/ip6tables-legacy-multi']}, 'selection_params': {'CommandLine|contains': ['-F', '-Z', '-X']}, 'selection_ufw': {'CommandLine|contains': ['ufw-logging-deny', 'ufw-logging-allow', 'ufw6-logging-deny', 'ufw6-logging-allow']}, 'condition': 'all of selection_*'}","Image IN (""*/iptables"", ""*/xtables-legacy-multi"", ""*/iptables-legacy-multi"", ""*/ip6tables"", ""*/ip6tables-legacy-multi"") CommandLine IN (""*-F*"", ""*-Z*"", ""*-X*"") CommandLine IN (""*ufw-logging-deny*"", ""*ufw-logging-allow*"", ""*ufw6-logging-deny*"", ""*ufw6-logging-allow*"")"
proc_creation_lnx_cat_sudoers.yml,Cat Sudoers,0f79c4d2-4e1f-4683-9c36-b5469a665e06,Detects the execution of a cat /etc/sudoers to list all users that have sudo rights,猫Sudoers,检测执行猫 /etc /sudoer以列出所有具有sudo权利的用户,medium,https://github.com/sleventyeleven/linuxprivchecker/,"attack.reconnaissance, attack.t1592.004","product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'Image|endswith': ['/cat', 'grep', '/head', '/tail', '/more'], 'CommandLine|contains': ' /etc/sudoers'}, 'condition': 'selection'}","Image IN (""*/cat"", ""*grep"", ""*/head"", ""*/tail"", ""*/more"") CommandLine=""* /etc/sudoers*"""
proc_creation_lnx_usermod_susp_group.yml,User Added To Root/Sudoers Group Using Usermod,6a50f16c-3b7b-42d1-b081-0fdd3ba70a73,"Detects usage of the ""usermod"" binary to add users add users to the root or suoders groups",用户使用USERMOD添加到root/sudoers组,检测“ usermod”二进制的用法以将用户添加到根或suoders group,medium,"https://pberba.github.io/security/2021/11/23/linux-threat-hunting-for-persistence-account-creation-manipulation/, https://www.configserverfirewall.com/ubuntu-linux/ubuntu-add-user-to-root-group/","attack.privilege_escalation, attack.persistence","product: linux, service: None",,['Legitimate administrator activities'],,"{'selection': {'Image|endswith': '/usermod', 'CommandLine|contains': ['-aG root', '-aG sudoers']}, 'condition': 'selection'}","Image=""*/usermod"" CommandLine IN (""*-aG root*"", ""*-aG sudoers*"")"
proc_creation_lnx_system_network_discovery.yml,System Network Discovery - Linux,e7bd1cfa-b446-4c88-8afb-403bcd79e3fa,Detects enumeration of local network configuration,系统网络发现-Linux,检测本地网络配置的枚举,informational,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1016/T1016.md,"attack.discovery, attack.t1016","product: linux, service: None",,['Legitimate administration activities'],,"{'selection_img': {'Image|endswith': ['/firewall-cmd', '/ufw', '/iptables', '/netstat', '/ss', '/ip', '/ifconfig', '/systemd-resolve', '/route']}, 'selection_cli': {'CommandLine|contains': '/etc/resolv.conf'}, 'condition': '1 of selection_*'}","Image IN (""*/firewall-cmd"", ""*/ufw"", ""*/iptables"", ""*/netstat"", ""*/ss"", ""*/ip"", ""*/ifconfig"", ""*/systemd-resolve"", ""*/route"") OR CommandLine=""*/etc/resolv.conf*"""
proc_creation_lnx_esxcli_network_discovery.yml,ESXi Network Configuration Discovery Via ESXCLI,33e814e0-1f00-4e43-9c34-31fb7ae2b174,"Detects execution of the ""esxcli"" command with the ""network"" flag in order to retrieve information about the network configuration.",ESXI网络配置通过ESXCLI发现,用“网络”标志检测“ ESXCLI”命令的执行，以检索有关网络配置的信息。,medium,"https://www.crowdstrike.com/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/, https://developer.vmware.com/docs/11743/esxi-7-0-esxcli-command-reference/namespace/esxcli_network.html","attack.discovery, attack.t1033, attack.t1007","product: linux, service: None",,['Legitimate administration activities'],,"{'selection_img': {'Image|endswith': '/esxcli', 'CommandLine|contains': 'network'}, 'selection_cli': {'CommandLine|contains': [' get', ' list']}, 'condition': 'all of selection_*'}","Image=""*/esxcli"" CommandLine=""*network*"" CommandLine IN (""* get*"", ""* list*"")"
proc_creation_lnx_mount_hidepid.yml,Mount Execution With Hidepid Parameter,ec52985a-d024-41e3-8ff6-14169039a0b3,"Detects execution of the ""mount"" command with ""hidepid"" parameter to make invisible processes to other users from the system",使用hidepid参数安装执行,检测使用“ hidepid”参数的“ mount”命令的执行,medium,"https://blogs.blackberry.com/, https://www.cyberciti.biz/faq/linux-hide-processes-from-other-users/, https://twitter.com/Joseliyo_Jstnk/status/1620131033474822144","attack.credential_access, attack.t1564","product: linux, service: None",,['Unknown'],,"{'selection': {'Image|endswith': '/mount', 'CommandLine|contains|all': ['hidepid=2', ' -o ']}, 'condition': 'selection'}","Image=""*/mount"" CommandLine=""*hidepid=2*"" CommandLine=""* -o *"""
proc_creation_lnx_touch_susp.yml,Touch Suspicious Service File,31545105-3444-4584-bebf-c466353230d2,"Detects usage of the ""touch"" process in service file.",触摸可疑服务文件,检测服务文件中“触摸”过程的用法。,medium,"https://blogs.blackberry.com/, https://twitter.com/Joseliyo_Jstnk/status/1620131033474822144","attack.defense_evasion, attack.t1070.006","product: linux, service: None",,['Admin changing date of files.'],,"{'selection': {'Image|endswith': '/touch', 'CommandLine|contains': ' -t ', 'CommandLine|endswith': '.service'}, 'condition': 'selection'}","Image=""*/touch"" CommandLine=""* -t *"" CommandLine=""*.service"""
proc_creation_lnx_setgid_setuid.yml,Setuid and Setgid,c21c4eaa-ba2e-419a-92b2-8371703cbe21,Detects suspicious change of file privileges with chown and chmod commands,setuid和setgid,通过Chown和Chmod命令检测可疑的文件特权更改,low,"https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1548.001/T1548.001.md, https://attack.mitre.org/techniques/T1548/001/","attack.persistence, attack.t1548.001","product: linux, service: None",,['Legitimate administration activities'],,"{'selection_root': {'CommandLine|contains': 'chown root'}, 'selection_perm': {'CommandLine|contains': [' chmod u+s', ' chmod g+s']}, 'condition': 'all of selection_*'}","CommandLine=""*chown root*"" CommandLine IN (""* chmod u+s*"", ""* chmod g+s*"")"
proc_creation_lnx_chattr_immutable_removal.yml,Remove Immutable File Attribute,34979410-e4b5-4e5d-8cfb-389fdff05c12,Detects usage of the 'chattr' utility to remove immutable file attribute.,删除不变的文件属性,检测“ chattr”实用程序的用法以删除不变的文件属性。,medium,https://www.trendmicro.com/en_us/research/22/i/how-malicious-actors-abuse-native-linux-tools-in-their-attacks.html,"attack.defense_evasion, attack.t1222.002","product: linux, service: None",,['Administrator interacting with immutable files (e.g. for instance backups).'],,"{'selection': {'Image|endswith': '/chattr', 'CommandLine|contains': ' -i '}, 'condition': 'selection'}","Image=""*/chattr"" CommandLine=""* -i *"""
proc_creation_lnx_esxcli_vm_discovery.yml,ESXi VM List Discovery Via ESXCLI,5f1573a7-363b-4114-9208-ad7a61de46eb,"Detects execution of the ""esxcli"" command with the ""vm"" flag in order to retrieve information about the installed VMs.",ESXI VM列表通过ESXCLI发现,检测使用“ VM”标志的“ ESXCLI”命令的执行，以检索有关已安装的VM的信息。,medium,"https://www.crowdstrike.com/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/, https://developer.vmware.com/docs/11743/esxi-7-0-esxcli-command-reference/namespace/esxcli_vm.html, https://www.secuinfra.com/en/techtalk/hide-your-hypervisor-analysis-of-esxiargs-ransomware/, https://www.trendmicro.com/en_us/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices.html","attack.discovery, attack.t1033, attack.t1007","product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'Image|endswith': '/esxcli', 'CommandLine|contains': 'vm process', 'CommandLine|endswith': ' list'}, 'condition': 'selection'}","Image=""*/esxcli"" CommandLine=""*vm process*"" CommandLine=""* list"""
proc_creation_lnx_dd_file_overwrite.yml,DD File Overwrite,2953194b-e33c-4859-b9e8-05948c167447,Detects potential overwriting and deletion of a file using DD.,DD文件覆盖,检测使用DD对文件的潜在覆盖和删除。,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md#atomic-test-2---macoslinux---overwrite-file-with-dd,"attack.impact, attack.t1485","product: linux, service: None",,['Any user deleting files that way.'],,"{'selection1': {'Image': ['/bin/dd', '/usr/bin/dd']}, 'selection2': {'CommandLine|contains': 'of='}, 'selection3': {'CommandLine|contains': ['if=/dev/zero', 'if=/dev/null']}, 'condition': 'all of selection*'}","Image IN (""/bin/dd"", ""/usr/bin/dd"") CommandLine=""*of=*"" CommandLine IN (""*if=/dev/zero*"", ""*if=/dev/null*"")"
proc_creation_lnx_susp_history_delete.yml,History File Deletion,1182f3b3-e716-4efa-99ab-d2685d04360f,"Detects events in which a history file gets deleted, e.g. the ~/bash_history to remove traces of malicious activity",历史记录文件删除,检测将历史文件删除的事件，例如〜/bash_history删除恶意活动的痕迹,high,"https://github.com/sleventyeleven/linuxprivchecker/, https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.003/T1552.003.md","attack.impact, attack.t1565.001","product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'Image|endswith': ['/rm', '/unlink', '/shred']}, 'selection_history': [{'CommandLine|contains': ['/.bash_history', '/.zsh_history']}, {'CommandLine|endswith': ['_history', '.history', 'zhistory']}], 'condition': 'all of selection*'}","Image IN (""*/rm"", ""*/unlink"", ""*/shred"") CommandLine IN (""*/.bash_history*"", ""*/.zsh_history*"") OR CommandLine IN (""*_history"", ""*.history"", ""*zhistory"")"
proc_creation_lnx_capa_discovery.yml,Capabilities Discovery - Linux,d8d97d51-122d-4cdd-9e2f-01b4b4933530,"Detects usage of ""getcap"" binary. This is often used during recon activity to determine potential binaries that can be abused as GTFOBins or other.",功能发现-Linux,检测“ getCap”二进制的用法。这通常是在侦察活动中使用的，以确定可以滥用GTFOBINS或其他的潜在二进制文件。,low,"https://github.com/SaiSathvik1/Linux-Privilege-Escalation-Notes, https://github.com/carlospolop/PEASS-ng, https://github.com/diego-treitos/linux-smart-enumeration","attack.discovery, attack.t1083","product: linux, service: None",,['Unknown'],,"{'selection': {'Image|endswith': '/getcap', 'CommandLine|contains|windash': ' -r '}, 'condition': 'selection'}","Image=""*/getcap"" CommandLine=""* -r *"" OR CommandLine=""* /r *"""
proc_creation_lnx_esxcli_vm_kill.yml,ESXi VM Kill Via ESXCLI,2992ac4d-31e9-4325-99f2-b18a73221bb2,"Detects execution of the ""esxcli"" command with the ""vm"" and ""kill"" flag in order to kill/shutdown a specific VM.",ESXI VM通过ESXCLI杀死,检测使用“ VM”和“ Kill”标志的“ ESXCLI”命令的执行，以杀死/关闭特定的VM。,medium,"https://www.crowdstrike.com/blog/hypervisor-jackpotting-ecrime-actors-increase-targeting-of-esxi-servers/, https://developer.vmware.com/docs/11743/esxi-7-0-esxcli-command-reference/namespace/esxcli_vm.html, https://www.secuinfra.com/en/techtalk/hide-your-hypervisor-analysis-of-esxiargs-ransomware/, https://www.trendmicro.com/en_us/research/22/e/new-linux-based-ransomware-cheerscrypt-targets-exsi-devices.html",attack.execution,"product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'Image|endswith': '/esxcli', 'CommandLine|contains|all': ['vm process', 'kill']}, 'condition': 'selection'}","Image=""*/esxcli"" CommandLine=""*vm process*"" CommandLine=""*kill*"""
proc_creation_lnx_susp_container_residence_discovery.yml,Container Residence Discovery Via Proc Virtual FS,746c86fb-ccda-4816-8997-01386263acc4,"Detects potential container discovery via listing of certain kernel features in the ""/proc"" virtual filesystem",通过Proc Virtual FS发现集装箱居住,通过列出“/proc”虚拟文件系统中的某些内核功能来检测潜在的容器发现,low,"https://blog.skyplabs.net/posts/container-detection/, https://stackoverflow.com/questions/20010199/how-to-determine-if-a-process-runs-inside-lxc-docker","attack.discovery, attack.t1082","product: linux, service: None",,"['Legitimate system administrator usage of these commands', 'Some container tools or deployments may use these techniques natively to determine how they proceed with execution, and will need to be filtered']",,"{'selection_tools': {'Image|endswith': ['awk', '/cat', 'grep', '/head', '/less', '/more', '/nl', '/tail']}, 'selection_procfs_kthreadd': {'CommandLine|contains': '/proc/2/'}, 'selection_procfs_target': {'CommandLine|contains': '/proc/', 'CommandLine|endswith': ['/cgroup', '/sched']}, 'condition': 'selection_tools and 1 of selection_procfs_*'}","Image IN (""*awk"", ""*/cat"", ""*grep"", ""*/head"", ""*/less"", ""*/more"", ""*/nl"", ""*/tail"") CommandLine=""*/proc/2/*"" OR (CommandLine=""*/proc/*"" CommandLine IN (""*/cgroup"", ""*/sched""))"
proc_creation_lnx_xterm_reverse_shell.yml,Potential Xterm Reverse Shell,4e25af4b-246d-44ea-8563-e42aacab006b,"Detects usage of ""xterm"" as a potential reverse shell tunnel",潜在的X -Term反向外壳,检测使用“ xterm”作为潜在的反向壳隧道的用法,medium,"https://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet, https://www.revshells.com/","attack.execution, attack.t1059","product: linux, service: None",,['Unknown'],,"{'selection': {'Image|contains': 'xterm', 'CommandLine|contains': '-display', 'CommandLine|endswith': ':1'}, 'condition': 'selection'}","Image=""*xterm*"" CommandLine=""*-display*"" CommandLine=""*:1"""
proc_creation_lnx_susp_recon_indicators.yml,Linux Recon Indicators,0cf7a157-8879-41a2-8f55-388dd23746b7,Detects events with patterns found in commands used for reconnaissance on linux systems,Linux侦察指示器,在Linux系统上使用用于侦察的命令中发现的模式检测事件,high,https://github.com/sleventyeleven/linuxprivchecker/blob/0d701080bbf92efd464e97d71a70f97c6f2cd658/linuxprivchecker.py,"attack.reconnaissance, attack.t1592.004, attack.credential_access, attack.t1552.001","product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'CommandLine|contains': [' -name .htpasswd', ' -perm -4000 ']}, 'condition': 'selection'}","CommandLine IN (""* -name .htpasswd*"", ""* -perm -4000 *"")"
proc_creation_lnx_remote_system_discovery.yml,Linux Remote System Discovery,11063ec2-de63-4153-935e-b1a8b9e616f1,Detects the enumeration of other remote systems.,Linux远程系统发现,检测其他远程系统的枚举。,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1018/T1018.md,"attack.discovery, attack.t1018","product: linux, service: None",,['Legitimate administration activities'],,"{'selection_1': {'Image|endswith': '/arp', 'CommandLine|contains': '-a'}, 'selection_2': {'Image|endswith': '/ping', 'CommandLine|contains': [' 10.', ' 192.168.', ' 172.16.', ' 172.17.', ' 172.18.', ' 172.19.', ' 172.20.', ' 172.21.', ' 172.22.', ' 172.23.', ' 172.24.', ' 172.25.', ' 172.26.', ' 172.27.', ' 172.28.', ' 172.29.', ' 172.30.', ' 172.31.', ' 127.', ' 169.254.']}, 'condition': '1 of selection*'}","(Image=""*/arp"" CommandLine=""*-a*"") OR (Image=""*/ping"" CommandLine IN (""* 10.*"", ""* 192.168.*"", ""* 172.16.*"", ""* 172.17.*"", ""* 172.18.*"", ""* 172.19.*"", ""* 172.20.*"", ""* 172.21.*"", ""* 172.22.*"", ""* 172.23.*"", ""* 172.24.*"", ""* 172.25.*"", ""* 172.26.*"", ""* 172.27.*"", ""* 172.28.*"", ""* 172.29.*"", ""* 172.30.*"", ""* 172.31.*"", ""* 127.*"", ""* 169.254.*""))"
proc_creation_lnx_local_account.yml,Local System Accounts Discovery - Linux,b45e3d6f-42c6-47d8-a478-df6bd6cf534c,Detects enumeration of local systeam accounts. This information can help adversaries determine which local accounts exist on a system to aid in follow-on behavior.,本地系统帐户发现-Linux,检测本地收费帐户的枚举。这些信息可以帮助对手确定系统上存在哪些本地帐户，以帮助跟随行为。,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1087.001/T1087.001.md,"attack.discovery, attack.t1087.001","product: linux, service: None",,['Legitimate administration activities'],,"{'selection_1': {'Image|endswith': '/lastlog'}, 'selection_2': {'CommandLine|contains': ""'x:0:'""}, 'selection_3': {'Image|endswith': ['/cat', '/head', '/tail', '/more'], 'CommandLine|contains': ['/etc/passwd', '/etc/shadow', '/etc/sudoers']}, 'selection_4': {'Image|endswith': '/id'}, 'selection_5': {'Image|endswith': '/lsof', 'CommandLine|contains': '-u'}, 'condition': '1 of selection*'}","Image=""*/lastlog"" OR CommandLine=""*'x:0:'*"" OR (Image IN (""*/cat"", ""*/head"", ""*/tail"", ""*/more"") CommandLine IN (""*/etc/passwd*"", ""*/etc/shadow*"", ""*/etc/sudoers*"")) OR Image=""*/id"" OR (Image=""*/lsof"" CommandLine=""*-u*"")"
proc_creation_lnx_remove_package.yml,Linux Package Uninstall,95d61234-7f56-465c-6f2d-b562c6fedbc4,"Detects linux package removal using builtin tools such as ""yum"", ""apt"", ""apt-get"" or ""dpkg"".",Linux软件包卸载,使用内置工具（例如“ yum”，“ apt”，“ apt-get”或“ dpkg”）检测Linux软件包删除。,low,"https://sysdig.com/blog/mitre-defense-evasion-falco, https://www.tutorialspoint.com/how-to-install-a-software-on-linux-using-yum-command, https://linuxhint.com/uninstall_yum_package/, https://linuxhint.com/uninstall-debian-packages/","attack.defense_evasion, attack.t1070","product: linux, service: None",,"['Administrator or administrator scripts might delete packages for several reasons (debugging, troubleshooting).']",,"{'selection_yum': {'Image|endswith': '/yum', 'CommandLine|contains': ['erase', 'remove']}, 'selection_apt': {'Image|endswith': ['/apt', '/apt-get'], 'CommandLine|contains': ['remove', 'purge']}, 'selection_dpkg': {'Image|endswith': '/dpkg', 'CommandLine|contains': ['--remove ', ' -r ']}, 'selection_rpm': {'Image|endswith': '/rpm', 'CommandLine|contains': ' -e '}, 'condition': '1 of selection_*'}","(Image=""*/yum"" CommandLine IN (""*erase*"", ""*remove*"")) OR (Image IN (""*/apt"", ""*/apt-get"") CommandLine IN (""*remove*"", ""*purge*"")) OR (Image=""*/dpkg"" CommandLine IN (""*--remove *"", ""* -r *"")) OR (Image=""*/rpm"" CommandLine=""* -e *"")"
proc_creation_lnx_susp_shell_child_process_from_parent_tmp_folder.yml,Shell Execution Of Process Located In Tmp Directory,2fade0b6-7423-4835-9d4f-335b39b83867,Detects execution of shells from a parent process located in a temporary (/tmp) directory,位于TMP目录中的过程的外壳执行,检测来自位于临时（/tmp）目录中的父进程的外壳执行,high,"https://blogs.jpcert.or.jp/en/2023/05/gobrat.html, https://jstnk9.github.io/jstnk9/research/GobRAT-Malware/, https://www.virustotal.com/gui/file/60bcd645450e4c846238cf0e7226dc40c84c96eba99f6b2cffcd0ab4a391c8b3/detection, https://www.virustotal.com/gui/file/3e44c807a25a56f4068b5b8186eee5002eed6f26d665a8b791c472ad154585d1/detection",attack.execution,"product: linux, service: None",,['Unknown'],,"{'selection': {'ParentImage|startswith': '/tmp/', 'Image|endswith': ['/bash', '/csh', '/dash', '/fish', '/ksh', '/sh', '/zsh']}, 'condition': 'selection'}","ParentImage=""/tmp/*"" Image IN (""*/bash"", ""*/csh"", ""*/dash"", ""*/fish"", ""*/ksh"", ""*/sh"", ""*/zsh"")"
proc_creation_lnx_susp_pipe_shell.yml,Linux Shell Pipe to Shell,880973f3-9708-491c-a77b-2a35a1921158,Detects suspicious process command line that starts with a shell that executes something and finally gets piped into another shell,Linux外壳管道到外壳,检测可疑的过程命令行，该命令行是从执行某件事的外壳开始，最后被管道输送到另一个外壳,medium,Internal Research,"attack.defense_evasion, attack.t1140","product: linux, service: None",,['Legitimate software that uses these patterns'],,"{'selection': {'CommandLine|startswith': ['sh -c ', 'bash -c ']}, 'selection_exec': [{'CommandLine|contains': ['| bash ', '| sh ', '|bash ', '|sh ']}, {'CommandLine|endswith': ['| bash', '| sh', '|bash', ' |sh']}], 'condition': 'all of selection*'}","CommandLine IN (""sh -c *"", ""bash -c *"") CommandLine IN (""*| bash *"", ""*| sh *"", ""*|bash *"", ""*|sh *"") OR CommandLine IN (""*| bash"", ""*| sh"", ""*|bash"", ""* |sh"")"
proc_creation_lnx_crypto_mining.yml,Linux Crypto Mining Indicators,9069ea3c-b213-4c52-be13-86506a227ab1,Detects command line parameters or strings often used by crypto miners,Linux加密挖掘指标,检测加密矿工经常使用的命令行参数或字符串,high,https://www.poolwatch.io/coin/monero,"attack.impact, attack.t1496","product: linux, service: None",,['Legitimate use of crypto miners'],,"{'selection': {'CommandLine|contains': [' --cpu-priority=', '--donate-level=0', ' -o pool.', ' --nicehash', ' --algo=rx/0 ', 'stratum+tcp://', 'stratum+udp://', 'sh -c /sbin/modprobe msr allow_writes=on', 'LS1kb25hdGUtbGV2ZWw9', '0tZG9uYXRlLWxldmVsP', 'tLWRvbmF0ZS1sZXZlbD', 'c3RyYXR1bSt0Y3A6Ly', 'N0cmF0dW0rdGNwOi8v', 'zdHJhdHVtK3RjcDovL', 'c3RyYXR1bSt1ZHA6Ly', 'N0cmF0dW0rdWRwOi8v', 'zdHJhdHVtK3VkcDovL']}, 'condition': 'selection'}","CommandLine IN (""* --cpu-priority=*"", ""*--donate-level=0*"", ""* -o pool.*"", ""* --nicehash*"", ""* --algo=rx/0 *"", ""*stratum+tcp://*"", ""*stratum+udp://*"", ""*sh -c /sbin/modprobe msr allow_writes=on*"", ""*LS1kb25hdGUtbGV2ZWw9*"", ""*0tZG9uYXRlLWxldmVsP*"", ""*tLWRvbmF0ZS1sZXZlbD*"", ""*c3RyYXR1bSt0Y3A6Ly*"", ""*N0cmF0dW0rdGNwOi8v*"", ""*zdHJhdHVtK3RjcDovL*"", ""*c3RyYXR1bSt1ZHA6Ly*"", ""*N0cmF0dW0rdWRwOi8v*"", ""*zdHJhdHVtK3VkcDovL*"")"
proc_creation_lnx_omigod_scx_runasprovider_executescript.yml,OMIGOD SCX RunAsProvider ExecuteScript,6eea1bf6-f8d2-488a-a742-e6ef6c1b67db,"Rule to detect the use of the SCX RunAsProvider ExecuteScript to execute any UNIX/Linux script using the /bin/sh shell.
Script being executed gets created as a temp file in /tmp folder with a scx* prefix.
Then it is invoked from the following directory /etc/opt/microsoft/scx/conf/tmpdir/.
The file in that directory has the same prefix scx*. SCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including
Microsoft Operations Manager, Microsoft Azure, and Microsoft Operations Management Suite.
",Omigod SCX RunasProvider executescript,"规则以检测使用SCX RunasProvider executeScript的使用以使用/bin/sh shell执行任何UNIX/Linux脚本。
被执行的脚本将作为使用SCX*前缀的 /TMP文件夹中的临时文件创建。
然后从以下目录/etc/opt/microsoft/scx/conf/tmpdir/调用它。
该目录中的文件具有相同的前缀SCX*。SCXCORE最初是Microsoft Operations Manager Unix/Linux代理，现在用于许多产品，包括
Microsoft Operations Manager，Microsoft Azure和Microsoft Operations Management Suite。",high,"https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure, https://github.com/Azure/Azure-Sentinel/pull/3059","attack.privilege_escalation, attack.initial_access, attack.execution, attack.t1068, attack.t1190, attack.t1203","product: linux, service: None",,['Legitimate use of SCX RunAsProvider ExecuteScript.'],,"{'selection': {'User': 'root', 'LogonId': 0, 'CurrentDirectory': '/var/opt/microsoft/scx/tmp', 'CommandLine|contains': '/etc/opt/microsoft/scx/conf/tmpdir/scx'}, 'condition': 'selection'}","User=""root"" LogonId=0 CurrentDirectory=""/var/opt/microsoft/scx/tmp"" CommandLine=""*/etc/opt/microsoft/scx/conf/tmpdir/scx*"""
proc_creation_lnx_install_suspicioua_packages.yml,Suspicious Package Installed - Linux,700fb7e8-2981-401c-8430-be58e189e741,Detects installation of suspicious packages using system installation utilities,已安装可疑软件包-Linux,使用系统安装实用程序检测可疑软件包的安装,medium,https://gist.githubusercontent.com/MichaelKoczwara/12faba9c061c12b5814b711166de8c2f/raw/e2068486692897b620c25fde1ea258c8218fe3d3/history.txt,"attack.defense_evasion, attack.t1553.004","product: linux, service: None",,['Legitimate administration activities'],,"{'selection_tool_apt': {'Image|endswith': ['/apt', '/apt-get'], 'CommandLine|contains': 'install'}, 'selection_tool_yum': {'Image|endswith': '/yum', 'CommandLine|contains': ['localinstall', 'install']}, 'selection_tool_rpm': {'Image|endswith': '/rpm', 'CommandLine|contains': '-i'}, 'selection_tool_dpkg': {'Image|endswith': '/dpkg', 'CommandLine|contains': ['--install', '-i']}, 'selection_keyword': {'CommandLine|contains': ['nmap', ' nc', 'netcat', 'wireshark', 'tshark', 'openconnect', 'proxychains']}, 'condition': '1 of selection_tool_* and selection_keyword'}","(Image IN (""*/apt"", ""*/apt-get"") CommandLine=""*install*"") OR (Image=""*/yum"" CommandLine IN (""*localinstall*"", ""*install*"")) OR (Image=""*/rpm"" CommandLine=""*-i*"") OR (Image=""*/dpkg"" CommandLine IN (""*--install*"", ""*-i*"")) CommandLine IN (""*nmap*"", ""* nc*"", ""*netcat*"", ""*wireshark*"", ""*tshark*"", ""*openconnect*"", ""*proxychains*"")"
proc_creation_lnx_base64_decode.yml,Decode Base64 Encoded Text,e2072cab-8c9a-459b-b63c-40ae79e27031,Detects usage of base64 utility to decode arbitrary base64-encoded text,解码base64编码文本,检测base64实用程序的使用以解码任意base 64编码的文本,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1027/T1027.md,"attack.defense_evasion, attack.t1027","product: linux, service: None",,['Legitimate activities'],,"{'selection': {'Image|endswith': '/base64', 'CommandLine|contains': '-d'}, 'condition': 'selection'}","Image=""*/base64"" CommandLine=""*-d*"""
proc_creation_lnx_sudo_cve_2019_14287.yml,Sudo Privilege Escalation CVE-2019-14287,f74107df-b6c6-4e80-bf00-4170b658162b,Detects users trying to exploit sudo vulnerability reported in CVE-2019-14287,sudo特权升级CVE-2019-14287,检测试图利用CVE-2019-14287报告的Sudo漏洞的用户,high,"https://www.openwall.com/lists/oss-security/2019/10/14/1, https://access.redhat.com/security/cve/cve-2019-14287, https://twitter.com/matthieugarin/status/1183970598210412546","attack.privilege_escalation, attack.t1068, attack.t1548.003, cve.2019.14287","product: linux, service: None",,['Unlikely'],,"{'selection': {'CommandLine|contains': ' -u#'}, 'condition': 'selection'}","CommandLine=""* -u#*"""
proc_creation_lnx_proxy_connection.yml,Connection Proxy,72f4ab3f-787d-495d-a55d-68c2ff46cf4c,Detects setting proxy configuration,连接代理,检测设置代理配置,low,https://attack.mitre.org/techniques/T1090/,"attack.defense_evasion, attack.t1090","product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'CommandLine|contains': ['http_proxy=', 'https_proxy=']}, 'condition': 'selection'}","CommandLine IN (""*http_proxy=*"", ""*https_proxy=*"")"
proc_creation_lnx_clipboard_collection.yml,Clipboard Collection with Xclip Tool,ec127035-a636-4b9a-8555-0efd4e59f316,"Detects attempts to collect data stored in the clipboard from users with the usage of xclip tool. Xclip has to be installed.
Highly recommended using rule on servers, due to high usage of clipboard utilities on user workstations.
",带有XCLIP工具的剪贴板收集,"检测尝试使用XCLIP工具的用法从用户那里收集存储在剪贴板中的数据。必须安装XCLIP。
由于用户工作站上剪贴板公用事业的大量使用，强烈建议使用服务器上的规则。",low,https://www.packetlabs.net/posts/clipboard-data-security/,"attack.collection, attack.t1115","product: linux, service: None",,['Legitimate usage of xclip tools.'],,"{'selection': {'Image|contains': 'xclip', 'CommandLine|contains|all': ['-sel', 'clip', '-o']}, 'condition': 'selection'}","Image=""*xclip*"" CommandLine=""*-sel*"" CommandLine=""*clip*"" CommandLine=""*-o*"""
proc_creation_lnx_process_discovery.yml,Process Discovery,4e2f5868-08d4-413d-899f-dc2f1508627b,"Detects process discovery commands. Adversaries may attempt to get information about running processes on a system.
Information obtained could be used to gain an understanding of common software/applications running on systems within the network
",过程发现,"检测过程发现命令。对手可能会尝试获取有关系统上运行过程的信息。
获得的信息可用于了解网络中系统上运行的常见软件/应​​用程序",informational,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1057/T1057.md,"attack.discovery, attack.t1057","product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'Image|endswith': ['/ps', '/top']}, 'condition': 'selection'}","Image IN (""*/ps"", ""*/top"")"
proc_creation_lnx_groupdel.yml,Group Has Been Deleted Via Groupdel,8a46f16c-8c4c-82d1-b121-0fdd3ba70a84,"Detects execution of the ""groupdel"" binary. Which is used to delete a group. This is sometimes abused by threat actors in order to cover their tracks",组已通过GroupDel删除,检测“ GroupDel”二进制的执行。用于删除组。有时威胁参与者滥用这是为了掩盖他们的轨道,medium,"https://linuxize.com/post/how-to-delete-group-in-linux/, https://www.cyberciti.biz/faq/linux-remove-user-command/, https://www.cybrary.it/blog/0p3n/linux-commands-used-attackers/, https://linux.die.net/man/8/groupdel","attack.impact, attack.t1531","product: linux, service: None",,['Legitimate administrator activities'],,"{'selection': {'Image|endswith': '/groupdel'}, 'condition': 'selection'}","Image=""*/groupdel"""
proc_creation_lnx_esxcli_user_account_creation.yml,ESXi Account Creation Via ESXCLI,b28e4eb3-8bbc-4f0c-819f-edfe8e2f25db,Detects user account creation on ESXi system via esxcli,通过ESXCLI创建ESXI帐户,通过ESXCLI在ESXI系统上检测用户帐户创建,medium,https://developer.vmware.com/docs/11743/esxi-7-0-esxcli-command-reference/namespace/esxcli_system.html,"attack.persistence, attack.t1136","product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'Image|endswith': '/esxcli', 'CommandLine|contains|all': ['system ', 'account ', 'add ']}, 'condition': 'selection'}","Image=""*/esxcli"" CommandLine=""*system *"" CommandLine=""*account *"" CommandLine=""*add *"""
proc_creation_lnx_cve_2022_33891_spark_shell_command_injection.yml,Apache Spark Shell Command Injection - ProcessCreation,c8a5f584-cdc8-42cc-8cce-0398e4265de3,Detects attempts to exploit an apache spark server via CVE-2014-6287 from a commandline perspective,apache spark shell命令注入 - 过程创造,从命令行的角度检测通过CVE-2014-6287来利用Apache Spark服务器的尝试,high,"https://github.com/W01fh4cker/cve-2022-33891/blob/fd973b56e78bca8822caa3a2e3cf1b5aff5d0950/cve_2022_33891_poc.py, https://sumsec.me/2022/CVE-2022-33891%20Apache%20Spark%20shell%20command%20injection.html, https://github.com/apache/spark/pull/36315/files","attack.initial_access, attack.t1190, cve.2022.33891","product: linux, service: None",,['Unlikely'],,"{'selection': {'ParentImage|endswith': '\\bash', 'CommandLine|contains': ['id -Gn `', ""id -Gn '""]}, 'condition': 'selection'}","ParentImage=""*\\bash"" CommandLine IN (""*id -Gn `*"", ""*id -Gn '*"")"
proc_creation_lnx_esxcli_vsan_discovery.yml,ESXi VSAN Information Discovery Via ESXCLI,d54c2f06-aca9-4e2b-81c9-5317858f4b79,"Detects execution of the ""esxcli"" command with the ""vsan"" flag in order to retrieve information about virtual storage. Seen used by malware such as DarkSide.",ESXI VSAN信息通过ESXCLI发现,检测使用“ vsan”标志的“ esxcli”命令的执行，以检索有关虚拟存储的信息。通过恶意软件（例如Darkside）使用。,medium,"https://www.trendmicro.com/en_us/research/21/e/darkside-linux-vms-targeted.html, https://www.trendmicro.com/en_us/research/22/a/analysis-and-Impact-of-lockbit-ransomwares-first-linux-and-vmware-esxi-variant.html, https://developer.vmware.com/docs/11743/esxi-7-0-esxcli-command-reference/namespace/esxcli_vsan.html","attack.discovery, attack.t1033, attack.t1007","product: linux, service: None",,['Legitimate administration activities'],,"{'selection_img': {'Image|endswith': '/esxcli', 'CommandLine|contains': 'vsan'}, 'selection_cli': {'CommandLine|contains': [' get', ' list']}, 'condition': 'all of selection_*'}","Image=""*/esxcli"" CommandLine=""*vsan*"" CommandLine IN (""* get*"", ""* list*"")"
proc_creation_lnx_disable_ufw.yml,Ufw Force Stop Using Ufw-Init,84c9e83c-599a-458a-a0cb-0ecce44e807a,Detects attempts to force stop the ufw using ufw-init,UFW力停止使用UFW-Init,检测尝试使用UFW-Init强制停止UFW,medium,"https://blogs.blackberry.com/, https://twitter.com/Joseliyo_Jstnk/status/1620131033474822144","attack.defense_evasion, attack.t1562.004","product: linux, service: None",,['Network administrators'],,"{'selection_init': {'CommandLine|contains|all': ['-ufw-init', 'force-stop']}, 'selection_ufw': {'CommandLine|contains|all': ['ufw', 'disable']}, 'condition': '1 of selection_*'}","(CommandLine=""*-ufw-init*"" CommandLine=""*force-stop*"") OR (CommandLine=""*ufw*"" CommandLine=""*disable*"")"
proc_creation_lnx_susp_chmod_directories.yml,Chmod Suspicious Directory,6419afd1-3742-47a5-a7e6-b50386cd15f8,Detects chmod targeting files in abnormal directory paths.,CHMOD可疑目录,在异常目录路径中检测CHMOD定位文件。,medium,"https://www.intezer.com/blog/malware-analysis/new-backdoor-sysjoker/, https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1222.002/T1222.002.md","attack.defense_evasion, attack.t1222.002","product: linux, service: None",,['Admin changing file permissions.'],,"{'selection': {'Image|endswith': '/chmod', 'CommandLine|contains': ['/tmp/', '/.Library/', '/etc/', '/opt/']}, 'condition': 'selection'}","Image=""*/chmod"" CommandLine IN (""*/tmp/*"", ""*/.Library/*"", ""*/etc/*"", ""*/opt/*"")"
proc_creation_lnx_system_info_discovery.yml,System Information Discovery,42df45e7-e6e9-43b5-8f26-bec5b39cc239,Detects system information discovery commands,系统信息发现,检测系统信息发现命令,informational,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1082/T1082.md,"attack.discovery, attack.t1082","product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'Image|endswith': ['/uname', '/hostname', '/uptime', '/lspci', '/dmidecode', '/lscpu', '/lsmod']}, 'condition': 'selection'}","Image IN (""*/uname"", ""*/hostname"", ""*/uptime"", ""*/lspci"", ""*/dmidecode"", ""*/lscpu"", ""*/lsmod"")"
proc_creation_lnx_susp_history_recon.yml,Print History File Contents,d7821ff1-4527-4e33-9f84-d0d57fa2fb66,Detects events in which someone prints the contents of history files to the commandline or redirects it to a file for reconnaissance,打印历史记录文件内容,检测某人将历史文件内容的内容打印到命令行或将其重定向到文件以进行侦察的事件,medium,"https://github.com/sleventyeleven/linuxprivchecker/, https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.003/T1552.003.md","attack.reconnaissance, attack.t1592.004","product: linux, service: None",,['Legitimate administration activities'],,"{'selection': {'Image|endswith': ['/cat', '/head', '/tail', '/more']}, 'selection_history': [{'CommandLine|contains': ['/.bash_history', '/.zsh_history']}, {'CommandLine|endswith': ['_history', '.history', 'zhistory']}], 'condition': 'all of selection*'}","Image IN (""*/cat"", ""*/head"", ""*/tail"", ""*/more"") CommandLine IN (""*/.bash_history*"", ""*/.zsh_history*"") OR CommandLine IN (""*_history"", ""*.history"", ""*zhistory"")"
proc_creation_lnx_esxcli_syslog_config_change.yml,ESXi Syslog Configuration Change Via ESXCLI,38eb1dbb-011f-40b1-a126-cf03a0210563,"Detects changes to the ESXi syslog configuration via ""esxcli""",ESXI Syslog配置通过ESXCLI更改,检测通过“ ESXCLI”对ESXI Syslog配置的变化,medium,"https://support.solarwinds.com/SuccessCenter/s/article/Configure-ESXi-Syslog-to-LEM?language=en_US, https://developer.vmware.com/docs/11743/esxi-7-0-esxcli-command-reference/namespace/esxcli_system.html","attack.defense_evasion, attack.t1562.001, attack.t1562.003","product: linux, service: None",,['Legitimate administrative activities'],,"{'selection': {'Image|endswith': '/esxcli', 'CommandLine|contains|all': ['system', 'syslog', 'config'], 'CommandLine|contains': ' set'}, 'condition': 'selection'}","Image=""*/esxcli"" CommandLine=""*system*"" CommandLine=""*syslog*"" CommandLine=""*config*"" CommandLine=""* set*"""
proc_creation_lnx_dd_process_injection.yml,Potential Linux Process Code Injection Via DD Utility,4cad6c64-d6df-42d6-8dae-eb78defdc415,"Detects the injection of code by overwriting the memory map of a Linux process using the ""dd"" Linux command.",潜在的Linux过程代码通过DD实用程序注入,通过使用“ DD” Linux命令覆盖Linux进程的内存图来检测代码的注入。,medium,"https://www.aon.com/cyber-solutions/aon_cyber_labs/linux-based-inter-process-code-injection-without-ptrace2/, https://github.com/AonCyberLabs/Cexigua/blob/34d338620afae4c6335ba8d8d499e1d7d3d5d7b5/overwrite.sh","attack.defense_evasion, attack.t1055.009","product: linux, service: None",,['Unknown'],,"{'selection': {'Image|endswith': '/dd', 'CommandLine|contains|all': ['of=', '/proc/', '/mem']}, 'condition': 'selection'}","Image=""*/dd"" CommandLine=""*of=*"" CommandLine=""*/proc/*"" CommandLine=""*/mem*"""
proc_creation_lnx_susp_interactive_bash.yml,Interactive Bash Suspicious Children,ea3ecad2-db86-4a89-ad0b-132a10d2db55,Detects suspicious interactive bash as a parent to rather uncommon child processes,互动式bash可疑孩子,发现可疑的互动式狂欢是父母，以罕见的儿童流程,medium,Internal Research,"attack.execution, attack.defense_evasion, attack.t1059.004, attack.t1036","product: linux, service: None",,['Legitimate software that uses these patterns'],,"{'selection': {'ParentCommandLine': 'bash -i'}, 'anomaly1': {'CommandLine|contains': ['-c import ', 'base64', 'pty.spawn']}, 'anomaly2': {'Image|endswith': ['whoami', 'iptables', '/ncat', '/nc', '/netcat']}, 'condition': 'selection and 1 of anomaly*'}","ParentCommandLine=""bash -i"" CommandLine IN (""*-c import *"", ""*base64*"", ""*pty.spawn*"") OR Image IN (""*whoami"", ""*iptables"", ""*/ncat"", ""*/nc"", ""*/netcat"")"
proc_creation_lnx_triple_cross_rootkit_install.yml,Triple Cross eBPF Rootkit Install Commands,22236d75-d5a0-4287-bf06-c93b1770860f,"Detects default install commands of the Triple Cross eBPF rootkit based on the ""deployer.sh"" script",三重交叉EBPF rootkit安装命令,检测基于“ deployer.sh”脚本的三重交叉EBPF rootkit的默认安装命令,high,https://github.com/h3xduck/TripleCross/blob/1f1c3e0958af8ad9f6ebe10ab442e75de33e91de/apps/deployer.sh,"attack.defense_evasion, attack.t1014","product: linux, service: None",,['Unlikely'],,"{'selection': {'Image|endswith': '/sudo', 'CommandLine|contains|all': [' tc ', ' enp0s3 '], 'CommandLine|contains': [' qdisc ', ' filter ']}, 'condition': 'selection'}","Image=""*/sudo"" CommandLine=""* tc *"" CommandLine=""* enp0s3 *"" CommandLine IN (""* qdisc *"", ""* filter *"")"
