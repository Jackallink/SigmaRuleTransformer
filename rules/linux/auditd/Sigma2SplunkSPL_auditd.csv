File Name,Rule Title,Rule ID,Rule Description,Chinese Title,Chinese Description,Level,References,Tags,Logsource,Fields,FalsePositive,Error Translation,Detection,SPL Query
lnx_auditd_masquerading_crond.yml,Masquerading as Linux Crond Process,9d4548fa-bba0-4e88-bd66-5d5bf516cda0,"Masquerading occurs when the name or location of an executable, legitimate or malicious, is manipulated or abused for the sake of evading defenses and observation.
Several different variations of this technique have been observed.
",伪装为Linux Crond过程,"为了逃避防御和观察，被操纵或虐待的可执行文件的名称或位置时，就会伪装。
已经观察到了该技术的几种不同变化。",medium,https://github.com/redcanaryco/atomic-red-team/blob/8a82e9b66a5b4f4bc5b91089e9f24e0544f20ad7/atomics/T1036.003/T1036.003.md#atomic-test-2---masquerading-as-linux-crond-process,"attack.defense_evasion, attack.t1036.003","product: linux, service: auditd",,[],,"{'selection': {'type': 'execve', 'a0': 'cp', 'a1': '/bin/sh', 'a2|endswith': '/crond'}, 'condition': 'selection'}","type=""execve"" a0=""cp"" a1=""/bin/sh"" a2=""*/crond"""
lnx_auditd_hidden_binary_execution.yml,Use Of Hidden Paths Or Files,9e1bef8d-0fff-46f6-8465-9aa54e128c1e,Detects calls to hidden files or files located in hidden directories in NIX systems.,使用隐藏路径或文件,检测NIX系统中隐藏目录中的隐藏文件或文件的调用。,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.001/T1564.001.md,"attack.defense_evasion, attack.t1574.001","product: linux, service: auditd",,['Unknown'],,"{'selection': {'type': 'PATH', 'name|contains': '/.'}, 'filter': {'name|contains': ['/.cache/', '/.config/', '/.pyenv/', '/.rustup/toolchains']}, 'condition': 'selection and not filter'}","type=""PATH"" name=""*/.*"" NOT (name IN (""*/.cache/*"", ""*/.config/*"", ""*/.pyenv/*"", ""*/.rustup/toolchains*""))"
lnx_auditd_clipboard_collection.yml,Clipboard Collection with Xclip Tool - Auditd,214e7e6c-f21b-47ff-bb6f-551b2d143fcf,"Detects attempts to collect data stored in the clipboard from users with the usage of xclip tool.
Xclip has to be installed.
Highly recommended using rule on servers, due to high usage of clipboard utilities on user workstations.
",带有XCLIP工具的剪贴板收集 - 审计,"检测尝试使用XCLIP工具的用法从用户那里收集存储在剪贴板中的数据。
必须安装XCLIP。
由于用户工作站上剪贴板公用事业的大量使用，强烈建议使用服务器上的规则。",low,"https://linux.die.net/man/1/xclip, https://www.cyberciti.biz/faq/xclip-linux-insert-files-command-output-intoclipboard/","attack.collection, attack.t1115","product: linux, service: auditd",,['Legitimate usage of xclip tools'],,"{'selection': {'type': 'EXECVE', 'a0': 'xclip', 'a1': ['-selection', '-sel'], 'a2': ['clipboard', 'clip'], 'a3': '-o'}, 'condition': 'selection'}","type=""EXECVE"" a0=""xclip"" a1 IN (""-selection"", ""-sel"") a2 IN (""clipboard"", ""clip"") a3=""-o"""
lnx_auditd_dd_delete_file.yml,Overwriting the File with Dev Zero or Null,37222991-11e9-4b6d-8bdf-60fbe48f753e,Detects overwriting (effectively wiping/deleting) of a file.,用Dev Zero或NULL覆盖文件,检测文件的覆盖（有效擦除/删除）。,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1485/T1485.md,"attack.impact, attack.t1485","product: linux, service: auditd",,"['Appending null bytes to files.', 'Legitimate overwrite of files.']",,"{'selection': {'type': 'EXECVE', 'a0|contains': 'dd', 'a1|contains': ['if=/dev/null', 'if=/dev/zero']}, 'condition': 'selection'}","type=""EXECVE"" a0=""*dd*"" a1 IN (""*if=/dev/null*"", ""*if=/dev/zero*"")"
lnx_auditd_chattr_immutable_removal.yml,Remove Immutable File Attribute - Auditd,a5b977d6-8a81-4475-91b9-49dbfcd941f7,Detects removing immutable file attribute.,删除不变的文件属性 - 审核,检测删除不变的文件属性。,medium,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1222.002/T1222.002.md,"attack.defense_evasion, attack.t1222.002","product: linux, service: auditd",,['Administrator interacting with immutable files (e.g. for instance backups).'],,"{'selection': {'type': 'EXECVE', 'a0|contains': 'chattr', 'a1|contains': '-i'}, 'condition': 'selection'}","type=""EXECVE"" a0=""*chattr*"" a1=""*-i*"""
lnx_auditd_bpfdoor_port_redirect.yml,Bpfdoor TCP Ports Redirect,70b4156e-50fc-4523-aa50-c9dddf1993fc,"All TCP traffic on particular port from attacker is routed to different port. ex. '/sbin/iptables -t nat -D PREROUTING -p tcp -s 192.168.1.1 --dport 22 -j REDIRECT --to-ports 42392'
The traffic looks like encrypted SSH communications going to TCP port 22, but in reality is being directed to the shell port once it hits the iptables rule for the attacker host only.
",BPFDoor TCP端口重定向,"攻击者特定端口上的所有TCP流量都将路由到其他端口。前任。'/sbin/iptables -t nat -d prerouting -p tcp -s 192.168.1.1--dport 22 -J redirect -to -ports -ports 42392'
流量看起来像是通往TCP端口22的加密SSH通信，但实际上，一旦仅针对攻击者主机击中了iptables规则，实际上就被指向壳端口。",medium,"https://www.sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/, https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor","attack.defense_evasion, attack.t1562.004","product: linux, service: auditd",,['Legitimate ports redirect'],,"{'cmd': {'type': 'EXECVE', 'a0|endswith': 'iptables', 'a1': '-t', 'a2': 'nat'}, 'keywords': ['--to-ports 42', '--to-ports 43'], 'condition': 'cmd and keywords'}","type=""EXECVE"" a0=""*iptables"" a1=""-t"" a2=""nat"" ""--to-ports 42"" OR ""--to-ports 43"""
lnx_auditd_file_or_folder_permissions.yml,File or Folder Permissions Change,74c01ace-0152-4094-8ae2-6fd776dd43e5,Detects file and folder permission changes.,文件或文件夹权限更改,检测文件和文件夹权限更改。,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1222.002/T1222.002.md,"attack.defense_evasion, attack.t1222.002","product: linux, service: auditd",,['User interacting with files permissions (normal/daily behaviour).'],,"{'selection': {'type': 'EXECVE', 'a0|contains': ['chmod', 'chown']}, 'condition': 'selection'}","type=""EXECVE"" a0 IN (""*chmod*"", ""*chown*"")"
lnx_auditd_system_info_discovery.yml,System Information Discovery - Auditd,f34047d9-20d3-4e8b-8672-0a35cc50dc71,Detects System Information Discovery commands,系统信息发现 - 审核,检测系统信息发现命令,low,https://github.com/redcanaryco/atomic-red-team/blob/f296668303c29d3f4c07e42bdd2b28d8dd6625f9/atomics/T1082/T1082.md,"attack.discovery, attack.t1082","product: linux, service: auditd",,['Likely'],,"{'selection_1': {'type': 'PATH', 'name': ['/etc/lsb-release', '/etc/redhat-release', '/etc/issue']}, 'selection_2': {'type': 'EXECVE', 'a0': ['uname', 'uptime', 'lsmod', 'hostname', 'env']}, 'selection_3': {'type': 'EXECVE', 'a0': 'grep', 'a1|contains': ['vbox', 'vm', 'xen', 'virtio', 'hv']}, 'selection_4': {'type': 'EXECVE', 'a0': 'kmod', 'a1': 'list'}, 'condition': '1 of selection_*'}","(type=""PATH"" name IN (""/etc/lsb-release"", ""/etc/redhat-release"", ""/etc/issue"")) OR (type=""EXECVE"" a0 IN (""uname"", ""uptime"", ""lsmod"", ""hostname"", ""env"")) OR (type=""EXECVE"" a0=""grep"" a1 IN (""*vbox*"", ""*vm*"", ""*xen*"", ""*virtio*"", ""*hv*"")) OR (type=""EXECVE"" a0=""kmod"" a1=""list"")"
lnx_auditd_steghide_embed_steganography.yml,Steganography Hide Files with Steghide,ce446a9e-30b9-4483-8e38-d2c9ad0a2280,"Detects embedding of files with usage of steghide binary, the adversaries may use this technique to prevent the detection of hidden information.",使用Steghide隐藏文件,检测使用Steghide二进制文件的文件嵌入，对手可以使用此技术来防止检测隐藏信息。,low,https://vitux.com/how-to-hide-confidential-files-in-images-on-debian-using-steganography/,"attack.defense_evasion, attack.t1027.003","product: linux, service: auditd",,['Unknown'],,"{'selection': {'type': 'EXECVE', 'a0': 'steghide', 'a1': 'embed', 'a2': ['-cf', '-ef'], 'a4': ['-cf', '-ef']}, 'condition': 'selection'}","type=""EXECVE"" a0=""steghide"" a1=""embed"" a2 IN (""-cf"", ""-ef"") a4 IN (""-cf"", ""-ef"")"
lnx_auditd_change_file_time_attr.yml,File Time Attribute Change - Linux,b3cec4e7-6901-4b0d-a02d-8ab2d8eb818b,Detect file time attribute change to hide new or changes to existing files.,文件时间属性更改-Linux,检测文件时间属性更改以隐藏新或更改现有文件。,medium,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1070.006/T1070.006.md,"attack.defense_evasion, attack.t1070.006","product: linux, service: auditd",,['Unknown'],,"{'execve': {'type': 'EXECVE'}, 'touch': ['touch'], 'selection2': ['-t', '-acmr', '-d', '-r'], 'condition': 'execve and touch and selection2'}","type=""EXECVE"" ""touch"" ""-t"" OR ""-acmr"" OR ""-d"" OR ""-r"""
lnx_auditd_data_compressed.yml,Data Compressed,a3b5e3e9-1b49-4119-8b8e-0344a01f21ee,"An adversary may compress data (e.g., sensitive documents) that is collected prior to exfiltration in order to make it portable and minimize the amount of data sent over the network.",数据压缩,对手可以压缩在去渗透之前收集的数据（例如，敏感文档），以使其可移植并最大程度地减少通过网络发送的数据量。,low,https://github.com/redcanaryco/atomic-red-team/blob/a78b9ed805ab9ea2e422e1aa7741e9407d82d7b1/atomics/T1560.001/T1560.001.md,"attack.exfiltration, attack.t1560.001","product: linux, service: auditd",,['Legitimate use of archiving tools by legitimate user.'],,"{'selection1': {'type': 'execve', 'a0': 'zip'}, 'selection2': {'type': 'execve', 'a0': 'gzip', 'a1': '-k'}, 'selection3': {'type': 'execve', 'a0': 'tar', 'a1|contains': '-c'}, 'condition': '1 of selection*'}","(type=""execve"" a0=""zip"") OR (type=""execve"" a0=""gzip"" a1=""-k"") OR (type=""execve"" a0=""tar"" a1=""*-c*"")"
lnx_auditd_bpfdoor_file_accessed.yml,BPFDoor Abnormal Process ID or Lock File Accessed,808146b2-9332-4d78-9416-d7e47012d83d,detects BPFDoor .lock and .pid files access in temporary file storage facility,bpfdoor异常过程ID或锁定文件已访问,在临时文件存储设施中检测bpfdoor .lock和.pid文件访问,high,"https://www.sandflysecurity.com/blog/bpfdoor-an-evasive-linux-backdoor-technical-analysis/, https://www.elastic.co/security-labs/a-peek-behind-the-bpfdoor","attack.execution, attack.t1106, attack.t1059","product: linux, service: auditd",,['Unlikely'],,"{'selection': {'type': 'PATH', 'name': ['/var/run/haldrund.pid', '/var/run/xinetd.lock', '/var/run/kdevrund.pid']}, 'condition': 'selection'}","type=""PATH"" name IN (""/var/run/haldrund.pid"", ""/var/run/xinetd.lock"", ""/var/run/kdevrund.pid"")"
lnx_auditd_audio_capture.yml,Audio Capture,a7af2487-9c2f-42e4-9bb9-ff961f0561d5,Detects attempts to record audio with arecord utility,音频捕获,检测尝试使用Arecord实用程序录制音频的尝试,low,"https://linux.die.net/man/1/arecord, https://linuxconfig.org/how-to-test-microphone-with-audio-linux-sound-architecture-alsa","attack.collection, attack.t1123","product: linux, service: auditd",,['Unknown'],,"{'selection': {'type': 'EXECVE', 'a0': 'arecord', 'a1': '-vv', 'a2': '-fdat'}, 'condition': 'selection'}","type=""EXECVE"" a0=""arecord"" a1=""-vv"" a2=""-fdat"""
lnx_auditd_auditing_config_change.yml,Auditing Configuration Changes on Linux Host,977ef627-4539-4875-adf4-ed8f780c4922,Detect changes in auditd configuration files,Linux主机上的审计配置更改,检测审计配置文件中的更改,high,"https://github.com/Neo23x0/auditd/blob/master/audit.rules, Self Experience","attack.defense_evasion, attack.t1562.006","product: linux, service: auditd","exe, comm, key",['Legitimate administrative activity'],,"{'selection': {'type': 'PATH', 'name': ['/etc/audit/*', '/etc/libaudit.conf', '/etc/audisp/*']}, 'condition': 'selection'}","type=""PATH"" name IN (""/etc/audit/*"", ""/etc/libaudit.conf"", ""/etc/audisp/*"") | table exe,comm,key"
lnx_auditd_network_service_scanning.yml,Linux Network Service Scanning - Auditd,3761e026-f259-44e6-8826-719ed8079408,Detects enumeration of local or remote network services.,Linux网络服务扫描 - 审核,检测本地或远程网络服务的枚举。,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1046/T1046.md,"attack.discovery, attack.t1046","product: linux, service: auditd",,['Legitimate administration activities'],,"{'selection': {'type': 'SYSCALL', 'exe|endswith': ['/telnet', '/nmap', '/netcat', '/nc', '/ncat', '/nc.openbsd'], 'key': 'network_connect_4'}, 'condition': 'selection'}","type=""SYSCALL"" exe IN (""*/telnet"", ""*/nmap"", ""*/netcat"", ""*/nc"", ""*/ncat"", ""*/nc.openbsd"") key=""network_connect_4"""
lnx_auditd_screencapture_import.yml,Screen Capture with Import Tool,dbe4b9c5-c254-4258-9688-d6af0b7967fd,"Detects adversary creating screen capture of a desktop with Import Tool.
Highly recommended using rule on servers, due to high usage of screenshot utilities on user workstations.
ImageMagick must be installed.
",用导入工具捕获屏幕截图,"检测使用导入工具的对手创建桌面的屏幕截图。
由于用户工作站上屏幕截图实用程序的大量使用，强烈建议使用服务器上的规则。
必须安装ImageMagick。",low,"https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1113/T1113.md, https://linux.die.net/man/1/import, https://imagemagick.org/","attack.collection, attack.t1113","product: linux, service: auditd",,['Legitimate use of screenshot utility'],,"{'import': {'type': 'EXECVE', 'a0': 'import'}, 'import_window_root': {'a1': '-window', 'a2': 'root', 'a3|endswith': ['.png', '.jpg', '.jpeg']}, 'import_no_window_root': {'a1|endswith': ['.png', '.jpg', '.jpeg']}, 'condition': 'import and (import_window_root or import_no_window_root)'}","type=""EXECVE"" a0=""import"" (a1=""-window"" a2=""root"" a3 IN (""*.png"", ""*.jpg"", ""*.jpeg"")) OR a1 IN (""*.png"", ""*.jpg"", ""*.jpeg"")"
lnx_auditd_coinminer.yml,Possible Coin Miner CPU Priority Param,071d5e5a-9cef-47ec-bc4e-a42e34d8d0ed,Detects command line parameter very often used with coin miners,可能的硬币矿工CPU优先级参数,检测命令行参数经常与硬币矿工一起使用,critical,https://xmrig.com/docs/miner/command-line-options,"attack.privilege_escalation, attack.t1068","product: linux, service: auditd",,['Other tools that use a --cpu-priority flag'],,"{'cmd1': {'a1|startswith': '--cpu-priority'}, 'cmd2': {'a2|startswith': '--cpu-priority'}, 'cmd3': {'a3|startswith': '--cpu-priority'}, 'cmd4': {'a4|startswith': '--cpu-priority'}, 'cmd5': {'a5|startswith': '--cpu-priority'}, 'cmd6': {'a6|startswith': '--cpu-priority'}, 'cmd7': {'a7|startswith': '--cpu-priority'}, 'condition': '1 of cmd*'}","a1=""--cpu-priority*"" OR a2=""--cpu-priority*"" OR a3=""--cpu-priority*"" OR a4=""--cpu-priority*"" OR a5=""--cpu-priority*"" OR a6=""--cpu-priority*"" OR a7=""--cpu-priority*"""
lnx_auditd_pers_systemd_reload.yml,Systemd Service Reload or Start,2625cc59-0634-40d0-821e-cb67382a3dd7,Detects a reload or a start of a service.,SystemD服务重新加载或开始,检测重新加载或服务的开始。,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1543.002/T1543.002.md,"attack.persistence, attack.t1543.002","product: linux, service: auditd",,"['Installation of legitimate service.', 'Legitimate reconfiguration of service.']",,"{'selection': {'type': 'EXECVE', 'a0|contains': 'systemctl', 'a1|contains': ['daemon-reload', 'start']}, 'condition': 'selection'}","type=""EXECVE"" a0=""*systemctl*"" a1 IN (""*daemon-reload*"", ""*start*"")"
lnx_auditd_susp_histfile_operations.yml,Suspicious History File Operations - Linux,eae8ce9f-bde9-47a6-8e79-f20d18419910,Detects commandline operations on shell history files,可疑历史文件操作 -  Linux,在Shell历史文件上检测命令行操作,medium,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.003/T1552.003.md,"attack.credential_access, attack.t1552.003","product: linux, service: auditd","a0, a1, a2, a3, key","['Legitimate administrative activity', 'Legitimate software, cleaning hist file']",,"{'execve': {'type': 'EXECVE'}, 'history': ['.bash_history', '.zsh_history', '.zhistory', '.history', '.sh_history', 'fish_history'], 'condition': 'execve and history'}","type=""EXECVE"" "".bash_history"" OR "".zsh_history"" OR "".zhistory"" OR "".history"" OR "".sh_history"" OR ""fish_history"" | table a0,a1,a2,a3,key"
lnx_auditd_screencaputre_xwd.yml,Screen Capture with Xwd,e2f17c5d-b02a-442b-9052-6eb89c9fec9c,"Detects adversary creating screen capture of a full with xwd. Highly recommended using rule on servers, due high usage of screenshot utilities on user workstations",用XWD捕获屏幕截图,检测对手创建XWD的完整屏幕捕获。强烈建议使用服务器上的规则，由于用户工作站上的屏幕截图实用程序高度使用,low,"https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1113/T1113.md#atomic-test-3---x-windows-capture, https://linux.die.net/man/1/xwd","attack.collection, attack.t1113","product: linux, service: auditd",,['Legitimate use of screenshot utility'],,"{'selection': {'type': 'EXECVE', 'a0': 'xwd'}, 'xwd_root_window': {'a1': '-root', 'a2': '-out', 'a3|endswith': '.xwd'}, 'xwd_no_root_window': {'a1': '-out', 'a2|endswith': '.xwd'}, 'condition': 'selection and 1 of xwd_*'}","type=""EXECVE"" a0=""xwd"" (a1=""-root"" a2=""-out"" a3=""*.xwd"") OR (a1=""-out"" a2=""*.xwd"")"
lnx_auditd_omigod_scx_runasprovider_executeshellcommand.yml,OMIGOD SCX RunAsProvider ExecuteShellCommand - Auditd,045b5f9c-49f7-4419-a236-9854fb3c827a,"Rule to detect the use of the SCX RunAsProvider Invoke_ExecuteShellCommand to execute any UNIX/Linux command using the /bin/sh shell.
SCXcore, started as the Microsoft Operations Manager UNIX/Linux Agent, is now used in a host of products including Microsoft Operations Manager.
Microsoft Azure, and Microsoft Operations Management Suite.
",Omigod SCX runasProvider executeshellcommand-审计,"规则以检测使用SCX RunasProvider Invoke_executeshellCommand使用/bin/sh shell执行任何UNIX/Linux命令。
SCXCORE最初是Microsoft Operations Manager Unix/Linux代理，现在用于包括Microsoft Operations Manager在内的许多产品中。
Microsoft Azure和Microsoft操作管理套件。",high,"https://www.wiz.io/blog/omigod-critical-vulnerabilities-in-omi-azure, https://github.com/Azure/Azure-Sentinel/pull/3059","attack.privilege_escalation, attack.initial_access, attack.execution, attack.t1068, attack.t1190, attack.t1203","product: linux, service: auditd",,['Legitimate use of SCX RunAsProvider Invoke_ExecuteShellCommand.'],,"{'selection': {'type': 'SYSCALL', 'syscall': 'execve', 'uid': 0, 'cwd': '/var/opt/microsoft/scx/tmp', 'comm': 'sh'}, 'condition': 'selection'}","type=""SYSCALL"" syscall=""execve"" uid=0 cwd=""/var/opt/microsoft/scx/tmp"" comm=""sh"""
lnx_auditd_systemd_service_creation.yml,Systemd Service Creation,1bac86ba-41aa-4f62-9d6b-405eac99b485,Detects a creation of systemd services which could be used by adversaries to execute malicious code.,SystemD服务创建,检测SystemD服务的创建，对手可以使用该服务来执行恶意代码。,medium,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1543.002/T1543.002.md,"attack.persistence, attack.t1543.002","product: linux, service: auditd",,['Admin work like legit service installs.'],,"{'path': {'type': 'PATH', 'nametype': 'CREATE'}, 'name_1': {'name|startswith': ['/usr/lib/systemd/system/', '/etc/systemd/system/']}, 'name_2': {'name|contains': '/.config/systemd/user/'}, 'condition': 'path and 1 of name_*'}","type=""PATH"" nametype=""CREATE"" name IN (""/usr/lib/systemd/system/*"", ""/etc/systemd/system/*"") OR name=""*/.config/systemd/user/*"""
lnx_auditd_user_discovery.yml,System Owner or User Discovery,9a0d8ca0-2385-4020-b6c6-cb6153ca56f3,"Adversaries may use the information from System Owner/User Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.",系统所有者或用户发现,对手可以在自动发现期间使用系统所有者/用户发现的信息来塑造跟进行为，包括对手是否完全感染了目标和/或尝试特定的操作。,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1033/T1033.md,"attack.discovery, attack.t1033","product: linux, service: auditd",,['Admin activity'],,"{'selection': {'type': 'EXECVE', 'a0': ['users', 'w', 'who']}, 'condition': 'selection'}","type=""EXECVE"" a0 IN (""users"", ""w"", ""who"")"
lnx_auditd_modify_system_firewall.yml,Modify System Firewall,323ff3f5-0013-4847-bbd4-250b5edb62cc,"Detects the removal of system firewall rules. Adversaries may only delete or modify a specific system firewall rule to bypass controls limiting network usage or access.
Detection rules that match only on the disabling of firewalls will miss this.
",修改系统防火墙,"检测系统防火墙规则的拆除。对手只能删除或修改特定的系统防火墙规则，以绕过控制网络使用或访问的限制。
仅在禁用防火墙的情况下匹配的检测规则会错过这一点。",medium,"https://www.trendmicro.com/en_us/research/22/c/cyclops-blink-sets-sights-on-asus-routers--.html, https://blog.aquasec.com/container-security-tnt-container-attack","attack.t1562.004, attack.defense_evasion","product: linux, service: auditd",,['Legitimate admin activity'],,"{'selection1': {'type': 'EXECVE', 'a0': 'iptables', 'a1|contains': 'DROP'}, 'selection2': {'type': 'EXECVE', 'a0': 'firewall-cmd', 'a1|contains': 'remove'}, 'selection3': {'type': 'EXECVE', 'a0': 'ufw', 'a1|contains': 'delete'}, 'condition': '1 of selection*'}","(type=""EXECVE"" a0=""iptables"" a1=""*DROP*"") OR (type=""EXECVE"" a0=""firewall-cmd"" a1=""*remove*"") OR (type=""EXECVE"" a0=""ufw"" a1=""*delete*"")"
lnx_auditd_susp_cmds.yml,Suspicious Commands Linux,1543ae20-cbdf-4ec1-8d12-7664d667a825,Detects relevant commands often related to malware or hacking activity,可疑命令Linux,检测通常与恶意软件或黑客活动有关的相关命令,medium,Internal Research - mostly derived from exploit code including code in MSF,"attack.execution, attack.t1059.004","product: linux, service: auditd",,['Admin activity'],,"{'cmd1': {'type': 'EXECVE', 'a0': 'chmod', 'a1': 777}, 'cmd2': {'type': 'EXECVE', 'a0': 'chmod', 'a1': 'u+s'}, 'cmd3': {'type': 'EXECVE', 'a0': 'cp', 'a1': '/bin/ksh'}, 'cmd4': {'type': 'EXECVE', 'a0': 'cp', 'a1': '/bin/sh'}, 'condition': '1 of cmd*'}","(type=""EXECVE"" a0=""chmod"" a1=777) OR (type=""EXECVE"" a0=""chmod"" a1=""u+s"") OR (type=""EXECVE"" a0=""cp"" a1=""/bin/ksh"") OR (type=""EXECVE"" a0=""cp"" a1=""/bin/sh"")"
lnx_auditd_load_module_insmod.yml,Loading of Kernel Module via Insmod,106d7cbd-80ff-4985-b682-a7043e5acb72,"Detects loading of kernel modules with insmod command.
Loadable Kernel Modules (LKMs) are pieces of code that can be loaded and unloaded into the kernel upon demand.
Adversaries may use LKMs to obtain persistence within the system or elevate the privileges.
",通过insmod加载内核模块,"使用InsMod命令检测内核模块的加载。
可加载的内核模块（LKMS）是可以按需加载并将其卸载到内核中的代码。
对手可以使用LKM在系统内获得持久性或提高特权。",high,"https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1547.006/T1547.006.md, https://linux.die.net/man/8/insmod, https://man7.org/linux/man-pages/man8/kmod.8.html","attack.persistence, attack.privilege_escalation, attack.t1547.006","product: linux, service: auditd",,['Unknown'],,"{'selection': {'type': 'SYSCALL', 'comm': 'insmod', 'exe': '/usr/bin/kmod'}, 'condition': 'selection'}","type=""SYSCALL"" comm=""insmod"" exe=""/usr/bin/kmod"""
lnx_auditd_system_info_discovery2.yml,System and Hardware Information Discovery,1f358e2e-cb63-43c3-b575-dfb072a6814f,Detects system information discovery commands,系统和硬件信息发现,检测系统信息发现命令,informational,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1082/T1082.md#atomic-test-4---linux-vm-check-via-hardware,"attack.discovery, attack.t1082","product: linux, service: auditd",,['Legitimate administration activities'],,"{'selection': {'type': 'PATH', 'name': ['/sys/class/dmi/id/bios_version', '/sys/class/dmi/id/product_name', '/sys/class/dmi/id/chassis_vendor', '/proc/scsi/scsi', '/proc/ide/hd0/model', '/proc/version', '/etc/*version', '/etc/*release', '/etc/issue']}, 'condition': 'selection'}","type=""PATH"" name IN (""/sys/class/dmi/id/bios_version"", ""/sys/class/dmi/id/product_name"", ""/sys/class/dmi/id/chassis_vendor"", ""/proc/scsi/scsi"", ""/proc/ide/hd0/model"", ""/proc/version"", ""/etc/*version"", ""/etc/*release"", ""/etc/issue"")"
lnx_auditd_logging_config_change.yml,Logging Configuration Changes on Linux Host,c830f15d-6f6e-430f-8074-6f73d6807841,Detect changes of syslog daemons configuration files,Linux主机上的记录配置更改,检测Syslog Daemons配置文件的更改,high,self experience,"attack.defense_evasion, attack.t1562.006","product: linux, service: auditd","exe, comm, key",['Legitimate administrative activity'],,"{'selection': {'type': 'PATH', 'name': ['/etc/syslog.conf', '/etc/rsyslog.conf', '/etc/syslog-ng/syslog-ng.conf']}, 'condition': 'selection'}","type=""PATH"" name IN (""/etc/syslog.conf"", ""/etc/rsyslog.conf"", ""/etc/syslog-ng/syslog-ng.conf"") | table exe,comm,key"
lnx_auditd_network_sniffing.yml,Network Sniffing - Linux,f4d3748a-65d1-4806-bd23-e25728081d01,"Network sniffing refers to using the network interface on a system to monitor or capture information sent over a wired or wireless connection.
An adversary may place a network interface into promiscuous mode to passively access data in transit over the network, or use span ports to capture a larger amount of data.
",网络嗅探-Linux,"网络嗅探是指使用系统上的网络接口来监视或捕获通过有线或无线连接发送的信息。
对手可以将网络接口放置在滥交模式中，以通过网络中的运输访问数据，或使用跨度端口捕获大量数据。",low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1040/T1040.md,"attack.credential_access, attack.discovery, attack.t1040","product: linux, service: auditd",,['Legitimate administrator or user uses network sniffing tool for legitimate reasons.'],,"{'selection_1': {'type': 'execve', 'a0': 'tcpdump', 'a1': '-c', 'a3|contains': '-i'}, 'selection_2': {'type': 'execve', 'a0': 'tshark', 'a1': '-c', 'a3': '-i'}, 'condition': '1 of selection_*'}","(type=""execve"" a0=""tcpdump"" a1=""-c"" a3=""*-i*"") OR (type=""execve"" a0=""tshark"" a1=""-c"" a3=""-i"")"
lnx_auditd_steghide_extract_steganography.yml,Steganography Extract Files with Steghide,a5a827d9-1bbe-4952-9293-c59d897eb41b,"Detects extraction of files with usage of steghide binary, the adversaries may use this technique to prevent the detection of hidden information.",使用Steghide的隐肌提取文件,检测使用Steghide二进制文件的文件提取，对手可能会使用此技术来防止检测隐藏信息。,low,https://vitux.com/how-to-hide-confidential-files-in-images-on-debian-using-steganography/,"attack.defense_evasion, attack.t1027.003","product: linux, service: auditd",,['Unknown'],,"{'selection': {'type': 'EXECVE', 'a0': 'steghide', 'a1': 'extract', 'a2': '-sf', 'a3|endswith': ['.jpg', '.png']}, 'condition': 'selection'}","type=""EXECVE"" a0=""steghide"" a1=""extract"" a2=""-sf"" a3 IN (""*.jpg"", ""*.png"")"
lnx_auditd_binary_padding.yml,Binary Padding - Linux,c52a914f-3d8b-4b2a-bb75-b3991e75f8ba,"Adversaries may use binary padding to add junk data and change the on-disk representation of malware.
This rule detect using dd and truncate to add a junk data to file.
",二进制填充-Linux,"对手可以使用二进制填充来添加垃圾数据并更改恶意软件的盘表示。
该规则使用DD检测并截断以添加垃圾数据以文件。",high,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1027.001/T1027.001.md,"attack.defense_evasion, attack.t1027.001","product: linux, service: auditd",,['Unknown'],,"{'selection_execve': {'type': 'EXECVE'}, 'keywords_truncate': {'|all': ['truncate', '-s']}, 'keywords_dd': {'|all': ['dd', 'if=']}, 'keywords_filter': ['of='], 'condition': 'selection_execve and (keywords_truncate or (keywords_dd and not keywords_filter))'}","type=""EXECVE"" (""truncate"" ""-s"") OR (""dd"" ""if="" NOT ""of="")"
lnx_auditd_capabilities_discovery.yml,Linux Capabilities Discovery,fe10751f-1995-40a5-aaa2-c97ccb4123fe,Detects attempts to discover the files with setuid/setgid capability on them. That would allow adversary to escalate their privileges.,Linux功能发现,检测试图在它们上发现具有setuID/setGID功能的文件。这将使对手能够升级他们的特权。,low,"https://man7.org/linux/man-pages/man8/getcap.8.html, https://www.hackingarticles.in/linux-privilege-escalation-using-capabilities/, https://mn3m.info/posts/suid-vs-capabilities/, https://int0x33.medium.com/day-44-linux-capabilities-privilege-escalation-via-openssl-with-selinux-enabled-and-enforced-74d2bec02099","attack.collection, attack.privilege_escalation, attack.t1123, attack.t1548","product: linux, service: auditd",,['Unknown'],,"{'selection': {'type': 'EXECVE', 'a0': 'getcap', 'a1': '-r', 'a2': '/'}, 'condition': 'selection'}","type=""EXECVE"" a0=""getcap"" a1=""-r"" a2=""/"""
lnx_auditd_unix_shell_configuration_modification.yml,Unix Shell Configuration Modification,a94cdd87-6c54-4678-a6cc-2814ffe5a13d,Detect unix shell configuration modification. Adversaries may establish persistence through executing malicious commands triggered when a new shell is opened.,Unix Shell配置修改,检测Unix Shell配置修改。对手可以通过在打开新外壳时执行触发的恶意命令来建立持久性。,medium,"https://objective-see.org/blog/blog_0x68.html, https://www.glitch-cat.com/p/green-lambert-and-attack, https://www.anomali.com/blog/pulling-linux-rabbit-rabbot-malware-out-of-a-hat","attack.persistence, attack.t1546.004","product: linux, service: auditd",,['Admin or User activity are expected to generate some false positives'],,"{'selection': {'type': 'PATH', 'name': ['/etc/shells', '/etc/profile', '/etc/profile.d/*', '/etc/bash.bashrc', '/etc/bashrc', '/etc/zsh/zprofile', '/etc/zsh/zshrc', '/etc/zsh/zlogin', '/etc/zsh/zlogout', '/etc/csh.cshrc', '/etc/csh.login', '/root/.bashrc', '/root/.bash_profile', '/root/.profile', '/root/.zshrc', '/root/.zprofile', '/home/*/.bashrc', '/home/*/.zshrc', '/home/*/.bash_profile', '/home/*/.zprofile', '/home/*/.profile', '/home/*/.bash_login', '/home/*/.bash_logout', '/home/*/.zlogin', '/home/*/.zlogout']}, 'condition': 'selection'}","type=""PATH"" name IN (""/etc/shells"", ""/etc/profile"", ""/etc/profile.d/*"", ""/etc/bash.bashrc"", ""/etc/bashrc"", ""/etc/zsh/zprofile"", ""/etc/zsh/zshrc"", ""/etc/zsh/zlogin"", ""/etc/zsh/zlogout"", ""/etc/csh.cshrc"", ""/etc/csh.login"", ""/root/.bashrc"", ""/root/.bash_profile"", ""/root/.profile"", ""/root/.zshrc"", ""/root/.zprofile"", ""/home/*/.bashrc"", ""/home/*/.zshrc"", ""/home/*/.bash_profile"", ""/home/*/.zprofile"", ""/home/*/.profile"", ""/home/*/.bash_login"", ""/home/*/.bash_logout"", ""/home/*/.zlogin"", ""/home/*/.zlogout"")"
lnx_auditd_disable_system_firewall.yml,Disable System Firewall,53059bc0-1472-438b-956a-7508a94a91f0,Detects disabling of system firewalls which could be used by adversaries to bypass controls that limit usage of the network.,禁用系统防火墙,检测对手可以使用的系统防火墙的禁用，以绕过限制网络使用的控制。,high,"https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1562.004/T1562.004.md, https://firewalld.org/documentation/man-pages/firewall-cmd.html","attack.t1562.004, attack.defense_evasion","product: linux, service: auditd",,['Admin activity'],,"{'selection': {'type': 'SERVICE_STOP', 'unit': ['firewalld', 'iptables', 'ufw']}, 'condition': 'selection'}","type=""SERVICE_STOP"" unit IN (""firewalld"", ""iptables"", ""ufw"")"
lnx_auditd_susp_c2_commands.yml,Suspicious C2 Activities,f7158a64-6204-4d6d-868a-6e6378b467e0,"Detects suspicious activities as declared by Florian Roth in its 'Best Practice Auditd Configuration'.
This includes the detection of the following commands; wget, curl, base64, nc, netcat, ncat, ssh, socat, wireshark, rawshark, rdesktop, nmap.
These commands match a few techniques from the tactics ""Command and Control"", including not exhaustively the following; Application Layer Protocol (T1071), Non-Application Layer Protocol (T1095), Data Encoding (T1132)
",可疑的C2活动,"发现弗洛里安·罗斯（Florian Roth）在其“最佳实践审计配置”中宣布的可疑活动。
这包括检测以下命令；WGET，Curl，Base64，NC，NetCat，NCAT，SSH，SOCAT，WIRESHARK，RAWSHARK，RAWSHARK，RDESKTOP，NMAP。
这些命令符合“命令和控制”策略的一些技术，包括以下几项；应用层协议（T1071），非应用层协议（T1095），数据编码（T1132）",medium,https://github.com/Neo23x0/auditd,attack.command_and_control,"product: linux, service: auditd",,['Admin or User activity'],,"{'selection': {'key': 'susp_activity'}, 'condition': 'selection'}","key=""susp_activity"""
lnx_auditd_clipboard_image_collection.yml,Clipboard Collection of Image Data with Xclip Tool,f200dc3f-b219-425d-a17e-c38467364816,"Detects attempts to collect image data stored in the clipboard from users with the usage of xclip tool.
Xclip has to be installed.
Highly recommended using rule on servers, due to high usage of clipboard utilities on user workstations.
",使用XCLIP工具收集图像数据的剪贴板,"检测尝试使用XCLIP工具的使用情况从用户那里收集存储在剪贴板中的图像数据。
必须安装XCLIP。
由于用户工作站上剪贴板公用事业的大量使用，强烈建议使用服务器上的规则。",low,https://linux.die.net/man/1/xclip,"attack.collection, attack.t1115","product: linux, service: auditd",,['Legitimate usage of xclip tools'],,"{'selection': {'type': 'EXECVE', 'a0': 'xclip', 'a1': ['-selection', '-sel'], 'a2': ['clipboard', 'clip'], 'a3': '-t', 'a4|startswith': 'image/', 'a5': '-o'}, 'condition': 'selection'}","type=""EXECVE"" a0=""xclip"" a1 IN (""-selection"", ""-sel"") a2 IN (""clipboard"", ""clip"") a3=""-t"" a4=""image/*"" a5=""-o"""
lnx_auditd_create_account.yml,Creation Of An User Account,759d0d51-bc99-4b5e-9add-8f5b2c8e7512,Detects the creation of a new user account. Such accounts may be used for persistence that do not require persistent remote access tools to be deployed on the system.,创建用户帐户,检测新用户帐户的创建。这些帐户可用于持久性，不需要持续的远程访问工具要在系统上部署。,medium,"https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/security_guide/sec-understanding_audit_log_files, https://access.redhat.com/articles/4409591#audit-record-types-2, https://www.youtube.com/watch?v=VmvY5SQm5-Y&ab_channel=M45C07","attack.t1136.001, attack.persistence","product: linux, service: auditd",,['Admin activity'],,"{'selection_syscall_record_type': {'type': 'SYSCALL', 'exe|endswith': '/useradd'}, 'selection_add_user_record_type': {'type': 'ADD_USER'}, 'condition': '1 of selection_*'}","(type=""SYSCALL"" exe=""*/useradd"") OR type=""ADD_USER"""
lnx_auditd_split_file_into_pieces.yml,Split A File Into Pieces - Linux,2dad0cba-c62a-4a4f-949f-5f6ecd619769,"Detection use of the command ""split"" to split files into parts and possible transfer.",将文件分成部分-Linux,检测命令“拆分”将文件分为部分并可能传输的使用。,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1030/T1030.md,"attack.exfiltration, attack.t1030","product: linux, service: auditd",,['Legitimate administrative activity'],,"{'selection': {'type': 'SYSCALL', 'comm': 'split'}, 'condition': 'selection'}","type=""SYSCALL"" comm=""split"""
lnx_auditd_system_shutdown_reboot.yml,System Shutdown/Reboot - Linux,4cb57c2f-1f29-41f8-893d-8bed8e1c1d2f,"Adversaries may shutdown/reboot systems to interrupt access to, or aid in the destruction of, those systems.",系统关闭/重新启动-Linux,对手可能会关闭/重新启动系统，以中断或有助于破坏这些系统。,informational,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1529/T1529.md,"attack.impact, attack.t1529","product: linux, service: auditd",,['Legitimate administrative activity'],,"{'execve': {'type': 'EXECVE'}, 'shutdowncmd': ['shutdown', 'reboot', 'halt', 'poweroff'], 'init': ['init', 'telinit'], 'initselection': [0, 6], 'condition': 'execve and (shutdowncmd or (init and initselection))'}","type=""EXECVE"" ""shutdown"" OR ""reboot"" OR ""halt"" OR ""poweroff"" OR (""init"" OR ""telinit"" 0 OR 6)"
lnx_auditd_ld_so_preload_mod.yml,Modification of ld.so.preload,4b3cb710-5e83-4715-8c45-8b2b5b3e5751,Identifies modification of ld.so.preload for shared object injection. This technique is used by attackers to load arbitrary code into processes.,Ld.so..preload的修改,确定对共享对象注入的LD.SO.SO.PRELOD的修改。攻击者使用此技术将任意代码加载到流程中。,high,"https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1574.006/T1574.006.md, https://eqllib.readthedocs.io/en/latest/analytics/fd9b987a-1101-4ed3-bda6-a70300eaf57e.html","attack.defense_evasion, attack.t1574.006","product: linux, service: auditd",,['Unknown'],,"{'selection': {'type': 'PATH', 'name': '/etc/ld.so.preload'}, 'condition': 'selection'}","type=""PATH"" name=""/etc/ld.so.preload"""
lnx_auditd_susp_exe_folders.yml,Program Executions in Suspicious Folders,a39d7fa7-3fbd-4dc2-97e1-d87f546b1bbc,Detects program executions in suspicious non-program folders related to malware or hacking activity,在可疑文件夹中执行程序,检测与恶意软件或黑客活动有关的可疑非程序文件夹中的程序执行,medium,Internal Research,"attack.t1587, attack.t1584, attack.resource_development","product: linux, service: auditd",,"['Admin activity (especially in /tmp folders)', 'Crazy web applications']",,"{'selection': {'type': 'SYSCALL', 'exe|startswith': ['/tmp/', '/var/www/', '/home/*/public_html/', '/usr/local/apache2/', '/usr/local/httpd/', '/var/apache/', '/srv/www/', '/home/httpd/html/', '/srv/http/', '/usr/share/nginx/html/', '/var/lib/pgsql/data/', '/usr/local/mysql/data/', '/var/lib/mysql/', '/var/vsftpd/', '/etc/bind/', '/var/named/']}, 'condition': 'selection'}","type=""SYSCALL"" exe IN (""/tmp/*"", ""/var/www/*"", ""/home/*/public_html/*"", ""/usr/local/apache2/*"", ""/usr/local/httpd/*"", ""/var/apache/*"", ""/srv/www/*"", ""/home/httpd/html/*"", ""/srv/http/*"", ""/usr/share/nginx/html/*"", ""/var/lib/pgsql/data/*"", ""/usr/local/mysql/data/*"", ""/var/lib/mysql/*"", ""/var/vsftpd/*"", ""/etc/bind/*"", ""/var/named/*"")"
lnx_auditd_web_rce.yml,Webshell Remote Command Execution,c0d3734d-330f-4a03-aae2-65dacc6a8222,Detects possible command execution by web application/web shell,webshel​​l远程命令执行,通过Web应用程序/Web Shell检测可能的命令执行,critical,Personal Experience of the Author,"attack.persistence, attack.t1505.003","product: linux, service: auditd",,"['Admin activity', 'Crazy web applications']",,"{'selection': {'type': 'SYSCALL', 'syscall': 'execve', 'key': 'detect_execve_www'}, 'condition': 'selection'}","type=""SYSCALL"" syscall=""execve"" key=""detect_execve_www"""
lnx_auditd_data_exfil_wget.yml,Data Exfiltration with Wget,cb39d16b-b3b6-4a7a-8222-1cf24b686ffc,"Detects attempts to post the file with the usage of wget utility.
The adversary can bypass the permission restriction with the misconfigured sudo permission for wget utility which could allow them to read files like /etc/shadow.
",WGET的数据去渗透,"检测尝试使用WGET实用程序的使用来发布文件。
对手可以使用WGET实用程序的错误配置的SUDO权限绕过权限限制，这可以使他们能够读取 /etc /shadow之类的文件。",medium,"https://linux.die.net/man/1/wget, https://gtfobins.github.io/gtfobins/wget/","attack.exfiltration, attack.t1048.003","product: linux, service: auditd",,['Legitimate usage of wget utility to post a file'],,"{'selection': {'type': 'EXECVE', 'a0': 'wget', 'a1|startswith': '--post-file='}, 'condition': 'selection'}","type=""EXECVE"" a0=""wget"" a1=""--post-file=*"""
lnx_auditd_hidden_zip_files_steganography.yml,Steganography Hide Zip Information in Picture File,45810b50-7edc-42ca-813b-bdac02fb946b,Detects appending of zip file to image,模拟隐藏zip信息在图片文件中,检测到将zip文件附加到图像,low,https://zerotoroot.me/steganography-hiding-a-zip-in-a-jpeg-file/,"attack.defense_evasion, attack.t1027.003","product: linux, service: auditd",,['Unknown'],,"{'commands': {'type': 'EXECVE', 'a0': 'cat'}, 'a1': {'a1|endswith': ['.jpg', '.png']}, 'a2': {'a2|endswith': '.zip'}, 'condition': 'commands and a1 and a2'}","type=""EXECVE"" a0=""cat"" a1 IN (""*.jpg"", ""*.png"") a2=""*.zip"""
lnx_auditd_unzip_hidden_zip_files_steganography.yml,Steganography Unzip Hidden Information From Picture File,edd595d7-7895-4fa7-acb3-85a18a8772ca,Detects extracting of zip file from image file,隐肌解压缩图片文件中隐藏的信息,从图像文件中检测提取zip文件的提取,low,https://zerotoroot.me/steganography-hiding-a-zip-in-a-jpeg-file/,"attack.defense_evasion, attack.t1027.003","product: linux, service: auditd",,['Unknown'],,"{'commands': {'type': 'EXECVE', 'a0': 'unzip'}, 'a1': {'a1|endswith': ['.jpg', '.png']}, 'condition': 'commands and a1'}","type=""EXECVE"" a0=""unzip"" a1 IN (""*.jpg"", ""*.png"")"
lnx_auditd_find_cred_in_files.yml,Credentials In Files - Linux,df3fcaea-2715-4214-99c5-0056ea59eb35,Detecting attempts to extract passwords with grep,文件中的凭据-Linux,检测尝试使用GREP提取密码的尝试,high,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1552.001/T1552.001.md,"attack.credential_access, attack.t1552.001","product: linux, service: auditd",,['Unknown'],,"{'selection': {'type': 'EXECVE'}, 'keywords': {'|all': ['grep', 'password']}, 'condition': 'selection and keywords'}","type=""EXECVE"" ""grep"" ""password"""
lnx_auditd_password_policy_discovery.yml,Password Policy Discovery,ca94a6db-8106-4737-9ed2-3e3bb826af0a,Detects password policy discovery commands,密码策略发现,检测密码策略发现命令,low,"https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1201/T1201.md, https://linux.die.net/man/1/chage, https://man7.org/linux/man-pages/man1/passwd.1.html, https://superuser.com/questions/150675/how-to-display-password-policy-information-for-a-user-ubuntu","attack.discovery, attack.t1201","product: linux, service: auditd",,['Legitimate administration activities'],,"{'selection_files': {'type': 'PATH', 'name': ['/etc/pam.d/common-password', '/etc/security/pwquality.conf', '/etc/pam.d/system-auth', '/etc/login.defs']}, 'selection_chage': {'type': 'EXECVE', 'a0': 'chage', 'a1': ['--list', '-l']}, 'selection_passwd': {'type': 'EXECVE', 'a0': 'passwd', 'a1': ['-S', '--status']}, 'condition': '1 of selection_*'}","(type=""PATH"" name IN (""/etc/pam.d/common-password"", ""/etc/security/pwquality.conf"", ""/etc/pam.d/system-auth"", ""/etc/login.defs"")) OR (type=""EXECVE"" a0=""chage"" a1 IN (""--list"", ""-l"")) OR (type=""EXECVE"" a0=""passwd"" a1 IN (""-S"", ""--status""))"
lnx_auditd_hidden_files_directories.yml,Hidden Files and Directories,d08722cd-3d09-449a-80b4-83ea2d9d4616,"Detects adversary creating hidden file or directory, by detecting directories or files with . as the first character",隐藏的文件和目录,通过检测使用目录或文件来检测对手创建隐藏的文件或目录。作为第一个角色,low,https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1564.001/T1564.001.md,"attack.defense_evasion, attack.t1564.001","product: linux, service: auditd",,['Unknown'],,"{'commands': {'type': 'EXECVE', 'a0': ['mkdir', 'touch', 'vim', 'nano', 'vi']}, 'arguments': [{'a1|contains': '/.'}, {'a1|startswith': '.'}, {'a2|contains': '/.'}, {'a2|startswith': '.'}], 'condition': 'commands and arguments'}","type=""EXECVE"" a0 IN (""mkdir"", ""touch"", ""vim"", ""nano"", ""vi"") a1=""*/.*"" OR a1="".*"" OR a2=""*/.*"" OR a2="".*"""
lnx_auditd_keylogging_with_pam_d.yml,Linux Keylogging with Pam.d,49aae26c-450e-448b-911d-b3c13d178dfc,Detect attempt to enable auditing of TTY input,linux键盘记录与pam.d,检测尝试启用TTY输入的尝试,high,"https://github.com/redcanaryco/atomic-red-team/blob/f339e7da7d05f6057fdfcdd3742bfcf365fee2a9/atomics/T1056.001/T1056.001.md, https://linux.die.net/man/8/pam_tty_audit, https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/6/html/security_guide/sec-configuring_pam_for_auditing, https://access.redhat.com/articles/4409591#audit-record-types-2","attack.credential_access, attack.t1003, attack.t1056.001","product: linux, service: auditd",,['Administrative work'],,"{'selection_path_events': {'type': 'PATH', 'name': ['/etc/pam.d/system-auth', '/etc/pam.d/password-auth']}, 'selection_tty_events': {'type': ['TTY', 'USER_TTY']}, 'condition': '1 of selection_*'}","(type=""PATH"" name IN (""/etc/pam.d/system-auth"", ""/etc/pam.d/password-auth"")) OR type IN (""TTY"", ""USER_TTY"")"
